<schema extends="../../zope/app/server/schema.xml">

    <!--
    The syntax of this file is documented in lib/ZConfig/doc/zconfig.pdf

    I think we should avoid using anything except strings as configuration
    items. Although we could stick complex objects into the configuration,
    this will make using the configuration complex and surprising. Instead,
    I suggest that the complex objects kept as utilities that use the
    configuration to set themselves up.

    It would be possible to split this file up into a number of smaller
    components, tieing the configuration to particular areas.
    -->

    <!-- First we define all the section types. -->

    <sectiontype name="database_options">
        <key name="dbhost" datatype="ipaddr-or-hostname" required="no" />
        <key name="dbname" datatype="string" required="no" />
        <key name="db_statement_timeout" datatype="integer" required="no">
            <description>
                SQL statement timeout in milliseconds. If a statement
                takes longer than this to execute, then it will be aborted.
                A value of 0 turns off the timeout. If this value is not set,
                PostgreSQL's default setting is used.
            </description>
        </key>
        <key name="db_statement_timeout_precision" datatype="integer"
            required="no" default="5000">
            <description>
                The statement timeout will be updated after this many
                ms of statements being executed, decreasing the statement
                timeout while the request is being processed. We don't just
                update the statement timeout after every query to control
                the number of unnecessary db queries sent.
            </description>
        </key>
        <key name="soft_request_timeout" datatype="integer" required="no">
            <description>
                A soft request timeout in milliseconds.  If a request
                takes longer than this timeout, an oops will be logged.

                If unset, requests will not cause soft timeouts.
            </description>
        </key>
        <key name="randomise_select_results" datatype="boolean"
             required="no" default="false" />
    </sectiontype>

    <sectiontype name="launchpad_session">
        <key name="dbuser" datatype="string" default="session" />
        <key name="dbhost" datatype="ipaddr-or-hostname" required="no" />
        <key name="dbname" datatype="string" default="session_prod" />
        <key name="cookie" datatype="string" default="launchpad" />
    </sectiontype>

    <sectiontype name="virtual_host">
        <key name="hostname" datatype="string" required="yes">
            <description>
                Host name of this virtual host.
                This is matched from the incoming Host header, and
                also used to put together URLs if rooturl is not provided.
                Example: launchpad.net
            </description>
        </key>
        <key name="althostnames" datatype="string" required="no">
            <description>
                Alternative host names to match, in addition to
                the one given in hostname, comma separated.
                Example: wwwww.launchpad.net, www.launchpad.net
            </description>
        </key>
        <key name="rooturl" datatype="string" required="no">
            <description>
                Explicit root URL for this virtual host.
                If this is not provided, the root URL is calculated
                based on the host name.
                Example: https://launchpad.net/
            </description>
        </key>
    </sectiontype>

    <sectiontype name="mainsite" extends="virtual_host" />
    <sectiontype name="blueprints" extends="virtual_host" />
    <sectiontype name="code" extends="virtual_host" />
    <sectiontype name="translations" extends="virtual_host" />
    <sectiontype name="bugs" extends="virtual_host" />
    <sectiontype name="answers" extends="virtual_host" />
    <sectiontype name="openid" extends="virtual_host" />
    <sectiontype name="shipitubuntu" extends="virtual_host" />
    <sectiontype name="shipitkubuntu" extends="virtual_host" />
    <sectiontype name="shipitedubuntu" extends="virtual_host" />
    <sectiontype name="xmlrpc" extends="virtual_host" />
    <sectiontype name="xmlrpc-private" extends="virtual_host" />

    <sectiontype name="virtual_hosts">
        <key name="use_https" datatype="boolean" required="yes">
            <description>
                When true, use https URLs unless explicitly overridden.
                When false, use http URLs unless explicitly overridden.
            </description>
        </key>
        <section name="*" type="mainsite" attribute="mainsite" required="yes" />
        <section name="*" type="blueprints" attribute="blueprints" required="yes" />
        <section name="*" type="code" attribute="code" required="yes" />
        <section name="*" type="translations" attribute="translations" required="yes" />
        <section name="*" type="bugs" attribute="bugs" required="yes" />
        <section name="*" type="answers" attribute="answers" required="yes" />
        <section name="*" type="openid" attribute="openid" required="yes" />
        <section name="*" type="shipitubuntu" attribute="shipitubuntu" required="yes" />
        <section name="*" type="shipitkubuntu" attribute="shipitkubuntu" required="yes" />
        <section name="*" type="shipitedubuntu" attribute="shipitedubuntu" required="yes" />
        <section name="*" type="xmlrpc" attribute="xmlrpc" required="yes" />
        <section name="*" type="xmlrpc-private" attribute="xmlrpc_private"
                          required="yes" />
    </sectiontype>

    <sectiontype name="launchpad_errorreports">
        <!-- Not 'existing-directory' because the test runner needs to
        create it. Not 'existing-dirpath' because ZConfig will enforce it
        for all sections, not just the one we are using -->
        <key name="errordir" datatype="string" required="yes">
            <description>
                Directory to write error reports to.
            </description>
        </key>
        <key name="oops_prefix" datatype="string" required="yes">
            <description>
                A prefix for "OOPS" codes for this Launchpad instance.
                This is used to allow storing the reports from different
                Launchpad instances in the same directory structure.
            </description>
        </key>
        <key name="copy_to_zlog" datatype="boolean" default="false">
            <description>
                Should exceptions be sent to the log as well as being
                saved to disk?
            </description>
        </key>
    </sectiontype>

    <sectiontype name="script_errorreports">
        <key name="errordir" datatype="string" required="no">
            <description>
                Directory to write error reports to.
            </description>
        </key>
        <key name="oops_prefix" datatype="string" required="yes">
            <description>
                A prefix for "OOPS" codes for this script.
k            </description>
        </key>
        <key name="copy_to_zlog" datatype="boolean">
            <description>
                Should exceptions be sent to the log as well as being
                saved to disk?
            </description>
        </key>
    </sectiontype>


    <sectiontype name="launchpad" extends="database_options">
        <key name="dbuser" datatype="string" default="launchpad" />
        <key name="cookie_domains" datatype="canonical.config.commalist"
            default="demo.launchpad.net, staging.launchpad.net, launchpad.net, launchpad.dev">
            <description>
                Session cookies being sent to a subdomain of the parent
                domains listed here will be sent to the parent domain,
                allowing sessions to be shared between vhosts.
                Domains should not start with a leading '.'.
            </description>
        </key>
        <key name="errors_address" datatype="string" required="no"
            default="launchpad-error-reports@lists.canonical.com" />
        <key name="bugs_domain" datatype="string" required="no"
            default="bugs.launchpad.net" />
        <key name="specs_domain" datatype="string" required="no"
            default="specs.launchpad.net" />
        <key name="oops_root_url" datatype="canonical.config.urlbase"
            default="https://devpad.canonical.com/~jamesh/oops.cgi/" />
        <key name="default_batch_size" datatype="integer" required="no"
            default="50" />
        <key name="branchlisting_batch_size" datatype="integer" required="no"
            default="100" />
        <key name="code_homepage_product_cloud_size" datatype="integer"
             required="no" default="120" />
        <key name="max_bug_attachment_size" datatype="integer" required="no"
            default="0">
            <description>
                Maximum size of bug attachments in bytes. A value of 0 means
                no limit.
            </description>
        </key>
        <key name="max_productrelease_file_size" datatype="integer" required="no"
            default="0">
            <description>
                Maximum size of product release download files in bytes. A value
                of 0 means no limit.
            </description>
        </key>
        <key name="browser_notification_level" required="no"
            datatype="canonical.config.loglevel" default="info" />
        <key name="bzr_imports_root_url" datatype="canonical.config.urlbase"
            default="http://escudero.ubuntu.com:680/">
            <description>
                The URL prefix for importd's bzr branches that it imports from
                other RCSes like CVS.  Used to generate URLs for the branch
                puller to use, not for public URLs.
            </description>
        </key>
        <key name="default_blob_expiry" datatype="integer" default="10800">
            <description>
                Number of seconds a blob stored in the temporary blob storage
                must remain before it may be garbage collected.
            </description>
        </key>
        <key name="max_blob_size" datatype="integer" default="0">
            <description>
                Maximum size of blobs that can be stored in the temporary
                blob storage. Set to 0 for unlimited.
            </description>
        </key>
        <section name="*" type="virtual_hosts" attribute="vhosts" required="no"
            />
        <key name="restrict_to_team" datatype="string" default="">
            <description>
            If this is provided, only members of the given team, and
            launchpad admins, may access the site.  Anonymous access is
            not allowed.  If this is provided, but not a known team name,
            only launchpad admins may access the site.
            </description>
        </key>
        <key name="http_proxy" datatype="string" default="http://squid.internal:3128/">
            <description>
                Proxy to be used when issuing HTTP requests.

                XXX: This should be in the canonical section, not the
                Launchpad section? At the moment, there are only scripts
                using this. -- StuartBishop 20070609
            </description>
        </key>
        <key name="is_demo" datatype="boolean" default="false">
            <description>
                If true, the main template will be styled so that it is
                obvious to the end user that they are using a demo system
                and that any changes they make will be lost at some point.
                This should not be true for any systems talking to the
                production database.
            </description>
        </key>
        <key name="site_message" datatype="string" default="">
            <description>
            If this is provided, the message given in the string will appear
            in the site status bar at the top of every page.
            </description>
        </key>
        <section name="*" type="launchpad_session" attribute="session"
            required="no" />
        <section name="*" type="launchpad_errorreports" attribute="errorreports"
            required="no" />
        <key name="beta_testers_redirection_host" datatype="string"
             required="no">
            <description>
                If set, the host name to redirect beta testers to.
            </description>
            <example>beta.launchpad.net</example>
        </key>
        <key name="openid_users" datatype="string"
            default="launchpad">
            <description>
                The team that can use Launchpad as an OpenID provider.
                Set to 'all' for open access.
            </description>
        </key>
        <key name="non_restricted_hostname" datatype="string"
             default="launchpad.net">
            <description>
                If restrict_to_team is set (such as on the beta
                website), then this indicates the hostname suffix for
                the non-restricted version of Launchpad.  Replacing
                config.launchpad.vhosts.mainsite.hostname with this
                value in a URI should give a valid host.

                This is intended to provide a way for non beta-testers
                to get back to the production instance if they are
                given a beta URL.
            </description>
        </key>
    </sectiontype>
    <sectiontype name="gina_target">
        <description>
            Gina will run against the target specified on the command line.
        </description>
        <key name="distro" datatype="string" required="yes">
            <description>
                The distribution name (e.g. ubuntu) from where the packages
                will be taken and to where they will be imported into
                launchpad. A distribution with name DISTRO must be created
                on launchpad before been used because gina is not able to
                create distributions.
            </description>
        </key>
        <key name="distrorelease" datatype="string" required="yes">
            <description>
                The distrorelease name (e.g. hoary) from where the packages
                will be taken and to where they will be imported (published)
                into launchpad. A distrorelease with name DISTRORELEASE inside
                the distrobution DISTRO must be created on launchpad before
                been used because gina is not able to create distroreleases.
            </description>
        </key>
        <key name="architectures" datatype="string"
            default="i386,powerpc,amd64">
            <description>
                A comma separated list with the architectures that should
                be imported into Launchpad. DistroArchRelease entries for
                this architectures having the architecturetag equal to each
                element in ARCHS should be created previously for the given
                DISTRORELEASE.
            </description>
            <example>i386,powerpc,amd64</example>
        </key>
        <key name="components" datatype="string"
            default="main,universe,restricted,multiverse">
            <description>
                A comma separated list with the component names
                that should be imported into launchpad. As well as in
                distribution and distrorelease the components must already
                exists inside launchpad. Currently the componentselection
                table is not checked but ideally it too should be populated.
            </description>
            <example>
                main,universe,restricted
            </example>
        </key>
        <!-- datatype really should be existing-directory, but keyrings
        are not installed on all production servers and they shouldn't need
        it installed if they are not running Gina. -->
        <key name="keyrings" datatype="string" default="/usr/share/keyrings">
            <description>
                A full path to where the keyrings files are
                available. These keyrings are used to look up who signed
                what wherever possible.
            </description>
        </key>
        <key name="root" datatype="string" required="yes">
            <description>
                ROOT is the full path to a debian-style archive from where
                the packages and its info will be read. This directory
                should contain a pool and dists pair of trees.
            </description>
        </key>
        <key name="pocket" datatype="string" default="release">
            <description>
                The pocket where this import should go. A "pocket" is a
                sub-archive for a distribution release. The default pocket
                is called "release", others are "security", "updates" and
                "proposed". There may be more. Packages can be published in
                a specific pocket after the release is made, before that
                they will always be published in the "release" pocket.
            </description>
            <metadefault>
                The "release" pocket is where packages are published
                before release.
            </metadefault>
            <example>updates</example>
        </key>

        <key name="pocketrelease" datatype="string" required="yes">
            <description>
                The distrorelease name to where packages should be published
                when working with pockets. Thats because on debian model
                hoary-updates can be seen as another distrorelease but it
                does not happens on launchpad.
            </description>
        </key>

        <key name="componentoverride" datatype="string" required="no">
            <description>
                If specified, override packages' components to this value.
                This only affects the publisher tables and may also override
                the archive according to the existing component/archive
                overriding rules.
            </description>
        </key>

        <key name="katie_dbname" datatype="string" required="no">
            <description>
                The Katie database that should be used to extract extra
                information from.
            </description>
        </key>

        <key name="source_only" datatype="boolean" default="false">
            <description>
                If true, only the source packages are imported and the
                binary packages ignored.
            </description>
        </key>

        <key name="sourcepackagenames_only" datatype="boolean" default="false">
            <description>
                If true, only the source package names are imported into
                Launchpad
            </description>
        </key>

    </sectiontype>

    <sectiontype name="gina" extends="database_options">
        <key name="dbuser" datatype="string" default="gina">
            <description>
                The database user which will be used to make the
                package imports.
            </description>
        </key>
        <multisection name="+" type="gina_target"
            attribute="target" required="no" />
    </sectiontype>

    <sectiontype name="librarian_server">
        <!-- Not 'existing-directory' because the test runner needs to
        create it. Not 'existing-dirpath' because ZConfig will enforce it
        for all sections, not just the one we are using -->
        <key name="root" datatype="string" required="yes" />
        <key name="launch" datatype="boolean" required="no" default="no" />
        <key name="spew" datatype="boolean" required="no" default="no" />
        <key name="upstream_host" datatype="ipaddr-or-hostname"
            required="no" />
        <key name="upstream_port" datatype="port-number" required="no"
            default="80" />
        <key name="logfile" datatype="string" required="no" default="-" />
    </sectiontype>

    <sectiontype name="librarian_gc" extends="database_options">
        <key name="dbuser" datatype="string" default="librariangc">
            <description>
                The user the librarian-gc.py garbage collection script connects
                as.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="librarian" extends="database_options">
        <key name="dbuser" datatype="string" default="librarian" />

        <key name="upload_port" datatype="port-number" required="yes">
            <description>
                Port number Librarian listens for storage requests on
            </description>
        </key>

        <key name="download_port" datatype="port-number" required="yes">
            <description>
                Port number Librarian listens for HTTP GET and
                HEAD requests on
            </description>
        </key>

        <key name="upload_host" datatype="ipaddr-or-hostname" required="yes">
            <description>
                Host Librarian is listening on for storage requests
            </description>
        </key>

        <key name="download_host" datatype="ipaddr-or-hostname" required="yes">
            <description>
                Host Librarian is listening on for HTTP requests
            </description>
        </key>

        <key name="download_url" datatype="canonical.config.urlbase"
            default="http://librarian.launchpad.net/">
            <description>
                The base URL used to generate URLs to the Library contents.
                Note that this might be on a different host or port to what is
                specified above if access to the Library is via Apache
                redirects.
            </description>
        </key>

        <!-- This is present because the buildd master uses download_url for
             itself and passes buildd_download_url to the slaves. -->
        <key name="buildd_download_url" datatype="canonical.config.urlbase"
            default="http://librarian.launchpad.net/">
            <description>
                The base URL used to generate URLs to the Library contents
                when passing URLs to the build daemons. This is likely to be
                a different host and port to the download url provided to
                external clients and is also likely to be proxied via Apache.
            </description>
        </key>

        <section name="*" type="librarian_server" attribute="server"
            required="no" />
        <section name="*" type="librarian_gc" attribute="gc"
            required="no" />
    </sectiontype>

    <sectiontype name="zopeless">
        <description>
            Clusters zopeless specific configuration. Ideally, this section
            will disappear as Zope3 land and Python land grow closer
        </description>
        <key name="send_email" datatype="boolean" required="yes" />
        <key name="smtp_host" datatype="ipaddr-or-hostname" required="no"
            default="localhost" />
        <key name="smtp_port" datatype="port-number" required="no"
            default="25" />
    </sectiontype>

    <sectiontype name="malone">
        <description>
            Malone-specific configuration options.
        </description>
        <key name="bugmail_error_from_address" datatype="string"
            required="yes" />
        <key name="buglist_batch_size" datatype="integer"
            required="no" default="20" />
        <key name="bugnotification_dbuser"
             datatype="string" required="no" default="bugnotification">
            <description>
                The database user which will be used to send bug
                notifications.
            </description>
        </key>
        <key name="bugnotification_interval" datatye="integer"
            required="no" default="5">
          <description>
              The number of minutes that at most should pass between
              changes to a bug to cause them to be grouped together into a
              single notification.
          </description>
        </key>
        <key name="debbugs_db_location" datatype="string"
            required="no" default="/srv/bugs-mirror.debian.org/" />
        <key name="max_comment_size" datatype="integer"
            required="no" default="3200">
          <description>
              The maximum number of characters a bug comment can be
              without being truncated when displayed on the main bug
              page.
          </description>
        </key>
        <key name="expiration_dbuser" datatype="string" 
            default="bugnotification">
            <description>
                The database user that will be used to expire bugtask.
            </description>
        </key>
        <key name="days_before_expiration" datatype="integer"
             default="60">
            <description>
                The number of days of inactivity required before an unassigned
                bugtask with the status of INCOMPLETE is expired.
            </description>
        </key>
        <key name="search_comments" datatype="boolean" required="no"
             default="no">
          <description>
            Whether comments should be searched when searching bugs.
          </description>
        </key>
    </sectiontype>

    <sectiontype name="shipit" extends="database_options">
        <description>
            Shipit-specific configuration options.
        </description>
        <key name="dbuser" datatype="string" default="shipit" />
        <key name="admins_email_address" datatype="string"
             default="info@shipit.ubuntu.com"/>
        <key name="ubuntu_from_email_address" datatype="string"
             default="noreply@shipit.ubuntu.com" />
        <key name="edubuntu_from_email_address" datatype="string"
             default="noreply@shipit.edubuntu.com" />
        <key name="kubuntu_from_email_address" datatype="string"
             default="noreply@shipit.kubuntu.com" />
    </sectiontype>

    <sectiontype name="rosettaadmin" extends="database_options">
        <description>
            Configuration for Rosetta admin tools
        </description>
        <key name="dbuser" datatype="string" default="rosettaadmin" />
        <key name="email" datatype="string" default="rosetta@launchpad.net">
            <description>
                From-address used in PO import, export and language pack
                notifications.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="poimport" extends="database_options">
        <description>
            Configuration for cronscripts/rosetta-poimport
        </description>
        <key name="dbuser" datatype="string" default="poimport" />
    </sectiontype>

    <sectiontype name="poattach" extends="database_options">
        <description>
            Configuration for cronscripts/rosetta-package-po-attach
        </description>
        <key name="dbuser" datatype="string" default="poattach" />
    </sectiontype>

    <sectiontype name="rosetta">
        <description>
            Rosetta-specific configuration options
        </description>
        <section name="*" type="rosettaadmin" attribute="rosettaadmin" required="no" />
        <section name="*" type="poimport" attribute="poimport" required="no" />
        <section name="*" type="poattach" attribute="poattach" required="no" />
    </sectiontype>

    <sectiontype name="gpghandler">
        <description>
            This utility is resposible for GPG operations like:
        sign/verify and encrypt/decrypt. it needs a "home" to allocate
        the runtime build configuration file and keyring and an
        address, "host:port",  pointing a reliable keyserver.
        </description>
        <key name="host" datatype="ipaddr-or-hostname" required="yes">
            <description>
                Host running PKS-like (SKS) keyserver Application.
            </description>
        </key>
        <key name="public_host" datatype="ipaddr-or-hostname" required="yes">
            <description>
                A public host running PKS-like (SKS) keyserver Application.
                This option is used to display links in the UI referring to
                the public keyserver.
            </description>
        </key>
        <key name="port" datatype="port-number" required="yes">
            <description>
                Port number on Host to access the keyserver
            </description>
        </key>
    </sectiontype>

    <sectiontype name="zeca">
        <description>
            Stubed Key server for test proposes, it's able to server
        in SKS fortmat, a restricted set of keys. (fixed address at
        localhost:11371)
        </description>
        <!-- Not 'existing-directory' because the test runner needs to
            create it  as librarian one-->
        <key name="root" datatype="string" required="no">
            <description>
                Directory to be created to store the pre-installed key-files
            </description>
        </key>
    </sectiontype>

    <sectiontype name="statistician" extends="database_options">
      <key name="dbuser" datatype="string" default="statistician" />
    </sectiontype>

    <sectiontype name="productreleasefinder" extends="database_options">
        <key name="dbuser" datatype="string" default="productreleasefinder" />
    </sectiontype>

    <sectiontype name="distributionmirrorprober" extends="database_options">
        <key name="dbuser" datatype="string" default="distributionmirror">
            <description>
                The database user which will be used to probe distribution
                mirrors.
            </description>
        </key>
        <key name="cdimage_file_list_url" datatype="string"
             default="http://releases.ubuntu.com/.manifest">
            <description>
                The URL to the file containing the list of ISO images that a
                mirror must contain.
            </description>
        </key>
        <key name="timeout" datatype="integer" default="30">
            <description>
                The time in seconds that the mirror prober will wait for a
                reply.
            </description>
        </key>
        <key name="use_proxy" datatype="boolean" default="true">
            <description>
                Should we set an http_proxy environment variable before
                running the prober?
            </description>
        </key>
        <key name="localhost_only" datatype="boolean" default="false">
            <description>
                If true, the mirror prober will only try to connect to
                localhost; all other hosts it'll return a success without
                even trying to connect.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="expiredmembershipsflagger" extends="database_options">
        <key name="dbuser" datatype="string" default="teammembership">
            <description>
                The database user which will be used to flag expired team
                memberships.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="karmacacheupdater" extends="database_options">
        <key name="dbuser" datatype="string" default="karma">
            <description>
                The database user which will be used to update the karmacache
                table.
            </description>
        </key>
        <key name="max_scaling" datatype="integer" default="500">
            <description>
                When calculating karma, if a categories scaling factor is
                larger than this it is reduced down to this maximum. This is
                to stop ridiculous spikes when a new category is added and
                there is little karma in the category's pool.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="targetnamecacheupdater" extends="database_options">
        <key name="dbuser" datatype="string" default="targetnamecacheupdater">
            <description>
                The database user which will be used to update the
                targetnamecache column of bugtasks.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="cveupdater" extends="database_options">
        <key name="cve_db_url" datatype="string" required="no"
             default="http://cve.mitre.org/cve/downloads/allitems.xml.gz" />
        <key name="dbuser" datatype="string" default="cve">
            <description>
                The database user which will be used to update the CVE
                database.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="answertracker" extends="database_options">
        <key name="dbuser" datatype="string" default="answertracker">
            <description>
                The database user which will be used to expire questions.
            </description>
        </key>
        <key name="email_domain" datatype="string"
            default="answers.launchpad.net" >
            <description>
                The email domain, to which incomings emails should be
                sent.
            </description>
        </key>
        <key name="days_before_expiration" datatype="integer"
             default="15">
            <description>
                The number of days of inactivity required before a question in
                the open or needs information state is expired.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="buildsequencer_job">
        <key name="command" datatype="string">
            <description>
                The subprocess to run. You can assume LPCONFIG will be set
                and that PYTHONPATH will be set to include the launchpad/lib
                directory and that CWD will be the top level of the launchpad
                tree itself. But that is all.
            </description>
        </key>
        <key name="mindelay" datatype="integer" default="1">
            <description>
                The minimum delay between invocations of this job type. The
                slavescanner probably wants to be set to 5 seconds or so but
                the queue builder probably wants 5 minutes or so (900 seconds).
                Other tasks will have varying requirements placed on them.
            </description>
        </key>
        <key name="alwayslog" datatype="boolean" default="false">
            <description>
                If set to true, the output of this job will always be logged to
                the sequencer log file.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="buildsequencer">
        <key name="mailproblemsto" datatype="string" default="">
            <description>
                If one of the subprocesses exits with a failure code then the
                build sequencer will email this address with the output of
                the subprocess. If this variable is set to a single dash then
                the output will simply be logged instead.
            </description>
        </key>
        <key name="launch" datatype="boolean" default="false">
            <description>
                If true, the buildsequencer will be started by the startup
                scripts.
            </description>
        </key>
        <key name="logfile" datatype="string">
            <description>
                The name of the log file for the sequencer (passed to twistd)
            </description>
        </key>
        <key name="spew" datatype="boolean" required="no" default="no" />
        <key name="smtphost" datatype="string" default="localhost"
            required="no" />
        <key name="fromaddress" datatype="string"
            default="launchpad@lists.canonical.com"
            required="no" />
        <multisection name="+" type="buildsequencer_job"
            attribute="jobs" required="no" />
    </sectiontype>

    <sectiontype name="uploader" extends="database_options">
        <key name="dbuser" datatype="string" required="yes" />
        <key name="default_recipient_name" datatype="string" required="yes" />
        <key name="default_sender_name" datatype="string" required="yes" />
        <key name="default_recipient_address" datatype="string"
             required="yes" />
        <key name="default_sender_address" datatype="string" required="yes" />
    </sectiontype>

    <sectiontype name="uploadqueue" extends="database_options">
        <key name="dbuser" datatype="string" required="yes" />
    </sectiontype>

    <sectiontype name="builddmaster" extends="database_options">
        <key name="dbuser" datatype="string" required="yes">
            <description>
                BuilddMaster Datatbase user.
            </description>
        </key>
        <key name="socket_timeout" datatype="integer" default="600">
            <description>
                The time in seconds that the builddmaster will wait for a
                reply from buildd slave.
            </description>
        </key>
        <key name="uploader" datatype="string" required="yes">
            <description>
                This is the command invoked by the buildd master when it wants
                to process a package upload into the launchpad. The buildd
                master splits the command on spaces so no escaping is allowed.
                If the token BUILDID is present, the build master will replace
                it with the ID of the build record for the upload.
                The build master will append the directory containing the files
                to the command before executing it.
            </description>
        </key>
        <key name="root" datatype="string" required="yes">
            <description>
                Directory to be created to store build results.
            </description>
        </key>
        <key name="crondaily_lockfile" datatype="string"
             default="/srv/launchpad.net/ubuntu-archive/cron.daily.lock">
            <description>
             cron.daily lockfile path, it's probed in order to suppress
             buildd-queue-builder runs during the publication process.
            </description>
        </key>
        <key name="send_build_notification" datatype="boolean"
             default="yes">
            <description>
             Activate the Build Notification system.
            </description>
        </key>
        <key name="notify_owner" datatype="boolean"
             default="yes">
            <description>
             Controls the notification of sourcepackagerelease.creator.
             If disable only the default_recipient will be notified.
            </description>
        </key>
        <key name="default_sender_name" datatype="string"
             default="Launchpad Buildd System"/>
        <key name="default_sender_address" datatype="string"
             default="noreply@launchpad.net"/>
    </sectiontype>

    <sectiontype name="mirror_puller_errorreports" extends="script_errorreports" />
    <sectiontype name="upload_puller_errorreports" extends="script_errorreports" />
    <sectiontype name="import_puller_errorreports" extends="script_errorreports" />

    <sectiontype name="supermirror" extends="database_options">
        <key name="dbuser" datatype="string" default="supermirror" />
        <key name="branchesdest" datatype="string" default="/var/tmp/sm-ng/mirrors" />
        <key name="masterlock" datatype="string" default="/var/tmp/sm-ng/masterlock" />
        <key name="authserver_url" datatype="canonical.config.urlbase"
             default="http://localhost:8999/branch/">
            <description>
                The XML-RPC endpoint URL for talking to the auth server
                to update branch mirror details.
            </description>
        </key>
        <key name="warehouse_root_url" datatype="canonical.config.urlbase">
            <description>
                URL prepended to branch ids to obtain internal branch URLs.
            </description>
        </key>
        <section name="*" type="mirror_puller_errorreports"
            attribute="mirror_errorreports" required="no" />
        <section name="*" type="upload_puller_errorreports"
            attribute="upload_errorreports" required="no" />
        <section name="*" type="import_puller_errorreports"
            attribute="import_errorreports" required="no" />
    </sectiontype>

    <sectiontype name="branchscanner" extends="database_options">
        <key name="dbuser" datatype="string" default="branchscanner">
            <description>
                The database user for the branch-scanner to update branches.
            </description>
        </key>
        <section name="*" type="script_errorreports" attribute="errorreports"
            required="no" />
    </sectiontype>

    <sectiontype name="codehosting">
        <key name="authserver" datatype="string" />
        <key name="host_key_pair_path" datatype="string" />
        <key name="branches_root" datatype="string" />
        <key name="banner" datatype="string" />
        <key name="port" datatype="string" default="tcp:5022" />
        <key name="launch" datatype="boolean" required="no" default="no" />
        <key name="spew" datatype="boolean" required="no" default="no" />
        <key name="logfile" datatype="string" required="no" default="-" />
        <key name="debug_logfile" datatype="string" required="no" />
        <key name="smartserver_root" datatype="canonical.config.urlbase"
            default="bzr+ssh://%(user)s@bazaar.launchpad.net/">
            <description>
                The prefix of the URL for the codehosting smart server.
                This value is usually not meaningful to change, so it should
                generally not be set explicitly so the default value is used.

                This should end with a slash.
            </description>
            <example>bzr+ssh://bazaar.launchpad.net/</example>
        </key>
        <key name="supermirror_root" datatype="canonical.config.urlbase"
            default="http://bazaar.launchpad.net/">
            <description>
                The prefix of the URL for the public area of the Supermirror.
                This value is usually not meaningful to change, so it should
                generally not be set explicitly so the default value is used.

                This should end with a slash.

                If that value is changed in production, the
                branch_url_constraint_not_supermirror database constraint
                should be updated.
            </description>
            <example>http://bazaar.launchpad.net/</example>
        </key>
        <key name="codebrowse_root" datatype="canonical.config.urlbase"
             default="http://codebrowse.launchpad.net/">
            <description>
                The URL prefix for links to the Bazaar code browser.
                Links are formed by appending the branch's unique name
                to the root URL.
            </description>
            <example>http://codebrowse.launchpad.net/</example>
        </key>
    </sectiontype>

    <sectiontype name="authserver" extends="database_options">
        <key name="dbuser" datatype="string" default="authserver" />
        <key name="port" datatype="string" default="tcp:8999" />
        <key name="launch" datatype="boolean" required="no" default="no" />
        <key name="spew" datatype="boolean" required="no" default="no" />
        <key name="logfile" datatype="string" required="no" default="-" />
    </sectiontype>

    <sectiontype name="production_errorreports" extends="script_errorreports" />
    <sectiontype name="autotest_errorreports" extends="script_errorreports" />

    <sectiontype name="importd" extends="database_options">
        <key name="dbuser" datatype="string">
            <description>
                The database user for importd and associated scripts.
            </description>
        </key>
        <section name="*" type="production_errorreports"
            attribute="production_errorreports" required="no" />
        <section name="*" type="autotest_errorreports"
            attribute="autotest_errorreports" required="no" />
    </sectiontype>

    <sectiontype name="personalpackagearchive">
        <key name="root" datatype="string" required="no"
             default="/var/tmp/ppa">
            <description>
                Directory to be created to store PPAs.
            </description>
        </key>
        <key name="base_url" datatype="string" required="no"
             default="http://ppa.launchpad.net">
            <description>
                External base URL for PPAs.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="archivepublisher">
        <key name="root" datatype="string" required="no"
            default="/var/tmp/archive/">
            <description>
                Base directory for distribution archives.
            </description>
        </key>
        <key name="base_url" datatype="string" required="no"
            default="http://archive.launchpad.net">
            <description>
                External base URL for distribution archives.
            </description>
        </key>
    </sectiontype>

    <sectiontype name="mailman-build"
                 prefix="canonical.launchpad.mailman.config">
        <key name="build"           datatype="boolean"      default="false" />
        <key name="prefix"          datatype=".prefix"      default=""      />
        <key name="var_dir"         datatype="string"
             default="/var/mailman"  />
        <key name="user_group"      datatype=".usergroup"   default="" />
        <key name="site_list_owner" datatype=".siteowner"   default="" />
        <key name="host_name"       datatype=".hostname"    default="" />
    </sectiontype>

    <sectiontype name="mailman" prefix="canonical.mailman.config">
        <section name="*" type="mailman-build"
                 attribute="build" required="yes" />

        <key name="launch" datatype="boolean"       default="false" />
        <key name="smtp"   datatype="inet-address"  default="localhost:25" />
        <key name="xmlrpc_url" datatype="string"
             default="http://xmlrpc.launchpad.dev:8087/mailinglists" />
        <key name="xmlrpc_runner_sleep" datatype="integer" default="10" />
    </sectiontype>

    <sectiontype name="checkwatches">
        <key name="batch_query_threshold" datatype="integer" default="10" />
        <key name="default_socket_timeout" datatype="integer" default="30" />
    </sectiontype>

    <sectiontype name="canonical" extends="database_options">
        <key name="chunkydiff" datatype="boolean"
            required="no" default="true" />
        <key name="show_tracebacks" datatype="boolean"
            required="no" default="false" />
        <key name="bounce_address" datatype="string" required="no"
            default="bounces@canonical.com" />
        <key name="noreply_from_address" datatype="string"
            required="no" default="noreply@launchpad.net" />
        <key name="admin_address" datatype="string" required="no"
            default="system-error@launchpad.net" />
        <key name="pid_dir" datatype="existing-directory" required="no"
            default="/tmp" />
        <section name="*" type="launchpad" attribute="launchpad" />
        <section name="*" type="malone" attribute="malone" />
        <section name="*" type="shipit" attribute="shipit" />
        <section name="*" type="rosetta" attribute="rosetta" />
        <section name="*" type="librarian" attribute="librarian" />
        <section name="*" type="zopeless" attribute="zopeless" />
        <section name="*" type="gpghandler" attribute="gpghandler" />
        <section name="*" type="zeca" attribute="zeca" />
        <section name="*" type="statistician" attribute="statistician" />
        <section name="*" type="productreleasefinder"
                 attribute="productreleasefinder" />
        <section name="*" type="gina" attribute="gina" />
        <section name="*" type="karmacacheupdater"
            attribute="karmacacheupdater" />
        <section name="*" type="expiredmembershipsflagger"
            attribute="expiredmembershipsflagger" />
        <section name="*" type="distributionmirrorprober"
            attribute="distributionmirrorprober" />
        <section name="*" type="targetnamecacheupdater"
            attribute="targetnamecacheupdater" />
        <section name="*" type="cveupdater" attribute="cveupdater" />
        <section name="*" type="answertracker" attribute="answertracker" />
        <section name="*" type="buildsequencer" attribute="buildsequencer" />
        <section name="*" type="uploader" attribute="uploader" />
        <section name="*" type="uploadqueue" attribute="uploadqueue" />
        <section name="*" type="supermirror" attribute="supermirror" />
        <section name="*" type="branchscanner" attribute="branchscanner" />
        <section name="*" type="builddmaster" attribute="builddmaster" />
        <section name="*" type="codehosting" attribute="codehosting" />
        <section name="*" type="authserver" attribute="authserver" />
        <section name="*" type="importd" attribute="importd" />
        <section name="*" type="personalpackagearchive"
            attribute="personalpackagearchive" />
        <section name="*" type="mailman" attribute="mailman" />
        <section name="*" type="archivepublisher" 
            attribute="archivepublisher" />
        <section name="*" type="checkwatches" attribute="checkwatches" />
    </sectiontype>

    <!-- Now specify where the section types may be rooted in the config file
    -->
    <multisection name="+" type="canonical" attribute="canonical" />
</schema>
