<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="view/macro:page/onecolumn"
  i18n:domain="launchpad"
>

<metal:heading fill-slot="head_epilogue">
    <style type="text/css">
    <!--
      td.good { background: lightgreen; }
      td.bad { background: #ffaaaa; }
      td.amount a { display: block; }
    -->
    </style>
</metal:heading>

  <body>
    <metal:portlets fill-slot="portlets">
    </metal:portlets>

    <div metal:fill-slot="help">
      <p>
      This report gives an overview of how good the bug communication is
      between a distribution and the upstream projects it produces
      packages from.
      </p>

      <p>
      Note that many of the counts in the table are linked to
      corresponding bug listings. The counts may disagree in certain
      corner cases and those should be verified through <a
      href="/ubuntu/+addquestion">a Launchpad question</a>. Details on
      the counts follow.
      </p>

      <dl>
        <dt>Open</dt><dd>Counts unfixed bugs on that package.</dd>
        <dt>Triaged</dt><dd>Counts unfixed bugs that have been marked as
        triaged by the official distribution triage team.</dd>
        <dt>Upstream</dt><dd>Of those bugs triaged, how many indicate they
        also affect an upstream project. Note that not all bugs filed
        against a distribution apply to an upstream project, so this
        percentage will rarely reach 100%.</dd>
        <dt>Watch</dt><dd>Of the triaged bugs affecting an upstream
        project, how many have bug watches pointing to remote bug
        trackers. It is a measure of how well we can monitor progress in
        the upstream project.  The watch column is blank for projects
        which use Launchpad for bug tracking since it implies that there
        is already direct communication between distribution and
        upstream.</dd>
        <dt>&Delta;</dt><dd>Deltas and percentages are relative to
        numbers in the previous category; for instance, the delta for
        watches is the number of upstreamed bugs minus the number of
        bugs with watches linked.</dd>
      </dl>

      <p>
      The colour green implies healthy activity for that specific value;
      so a green cell for Triaged means that a good rate of open bugs
      for that source package have been triaged.
      </p>
      <p>
      The colour red implies data that needs to be filled out in the
      project registration to allow the upstream bug submission process
      to work effectively. Links are provided to fix them for users with
      the appropriate permissions.
      </p>

    </div>

    <div metal:fill-slot="main">
      <h1>Upstream bug report for
        <tal:distro replace="context/displayname" /></h1>

      <tal:no-bugs tal:condition="not: view/data">
        <span tal:replace="context/displayname" /> has no bugs filed
        against it.
      </tal:no-bugs>

      <p class="warning message" tal:condition="view/data"
         style="width: 40%">
        This report is an alpha release and has accounting limitations.
        You can use it to guide your work, but do not take the
        percentages too literally. See the Help tab for information on
        the counts.
      </p>

      <table class="listing" id="upstream-report"
             tal:condition="view/data">
        <thead>
          <tr>
            <th>Package</th>
            <th colspan="2">Project</th>
            <th>Bug Tracker</th>
            <th>Upstream Contact</th>
            <th class="amount">Open</th>
            <th class="amount">Triaged</th>
            <th class="amount">%</th>
            <th class="amount">&Delta;</th>
            <th class="amount">Upstream</th>
            <th class="amount">%</th>
            <th class="amount">&Delta;</th>
            <th class="amount">Watch</th>
            <th class="amount">%</th>
            <th class="amount">&Delta;</th>
          </tr>
        </thead>
        <tbody id="upstream-report-content">
          <tr tal:repeat="item view/data">
            <td>
              <a tal:attributes="href item/dsp/fmt:url"
                 tal:content="item/dsp/name"></a>
            </td>
            <tal:has-product condition="item/product">
              <td style="padding-right: 0">
                <a tal:attributes="href item/series_branch/fmt:url;
                   title string:You can use `bzr branch lp:${item/product/name}' to fetch this project's code"
                   tal:condition="item/series_branch">
                  <img alt="(branch)" src="/@@/branch" /></a>
              </td>
              <td style="padding-left: 0">
                <a tal:attributes="href item/product/fmt:url"
                   tal:content="item/product/title"></a>
              </td>
              <tal:has-bugtracker condition="item/bugtracker">
                <td>
                  <a tal:attributes="href item/bugtracker/fmt:url"
                     tal:content="item/bugtracker/title"></a></td>
              </tal:has-bugtracker>
              <tal:has-no-bugtracker condition="not: item/bugtracker">
                <td tal:condition="item/official_malone" class="good">
                    Launchpad
                </td>
                <td tal:condition="not: item/official_malone"
                    align="center" class="bad">
                    Unknown
                    <a tal:condition="item/product/required:launchpad.Edit"
                       tal:attributes="href item/product_edit_url">
                       <small>(fix)</small></a></td>
              </tal:has-no-bugtracker>
              <tal:has-bug-supervisor condition="item/product/bug_supervisor">
                <td>
                  <a tal:attributes="href item/product/bug_supervisor/fmt:url"
                     tal:content="item/product/bug_supervisor/displayname"></a></td>
              </tal:has-bug-supervisor>
              <tal:has-no-bug-supervisor condition="not: item/product/bug_supervisor">
                <td align="center" class="bad">Unspecified
                    <a tal:condition="item/product/required:launchpad.Edit"
                       tal:attributes="href item/bug_supervisor_url">
                      <small>(change)</small></a></td>
              </tal:has-no-bug-supervisor>
            </tal:has-product>
            <tal:has-no-product condition="not: item/product">
                <td align="center" class="bad" colspan="4">
                    Missing corresponding product.
                    <a href="/projects"><small>(find)</small></a>
                    <a tal:condition="item/dssp"
                       tal:attributes="href item/packaging_url">
                       <small>(link)</small></a>
                </td>
            </tal:has-no-product>
            <td class="amount">
              <a tal:attributes="href item/open_bugs_url"
                 tal:content="item/open_bugs"></a>
            </td>
            <td tal:attributes="class string:amount ${item/triaged_bugs_class}">
              <a tal:attributes="href item/triaged_bugs_url"
                 tal:content="item/triaged_bugs"></a>
            </td>
            <td tal:attributes="class string:amount ${item/triaged_bugs_class}"
                tal:content="item/triaged_bugs_percentage/fmt:float/.2" />
            <td tal:attributes="class string:amount ${item/triaged_bugs_class}">
              <a tal:attributes="href item/triaged_bugs_delta_url"
                 tal:content="item/triaged_bugs_delta"></a>
            </td>
            <td tal:attributes="class string:amount ${item/upstream_bugs_class}">
              <a tal:attributes="href item/upstream_bugs_url"
                 tal:content="item/upstream_bugs"></a>
            </td>
            <td tal:attributes="class string:amount ${item/upstream_bugs_class}"
                tal:content="item/upstream_bugs_percentage/fmt:float/.2" />
            <td tal:attributes="class string:amount ${item/upstream_bugs_class}">
              <a tal:attributes="href item/upstream_bugs_delta_url"
                 tal:content="item/upstream_bugs_delta"></a>
            </td>
            <tal:upstream-in-launchpad 
                condition="item/official_malone">
                <td colspan="3" class="good">&nbsp;</td>
            </tal:upstream-in-launchpad>
            <tal:upstream-not-in-launchpad
                condition="not: item/official_malone">
              <td tal:attributes="class string:amount ${item/watched_bugs_class}"
                  tal:content="item/watched_bugs" />
              <td tal:attributes="class string:amount ${item/watched_bugs_class}"
                  tal:content="item/watched_bugs_percentage/fmt:float/.2" />
              <td tal:attributes="class string:amount ${item/watched_bugs_class}">
                <a tal:attributes="href item/watched_bugs_delta_url"
                   tal:content="item/watched_bugs_delta"></a>
              </td>
            </tal:upstream-not-in-launchpad>
          </tr>
        </tbody>
        <tfoot id="upstream-report-totals">
          <tr>
            <td colspan="5" class="amount"><b>Totals:</b></td>
            <td class="amount"
                tal:content="view/total/open_bugs" />
            <td class="amount"
                tal:content="view/total/triaged_bugs" />
            <td class="amount"
                tal:content="view/total/triaged_bugs_percentage/fmt:float/.2" />
            <td class="amount"
                tal:content="view/total/triaged_bugs_delta" />
            <td class="amount"
                tal:content="view/total/upstream_bugs" />
            <td class="amount"
                tal:content="view/total/upstream_bugs_percentage/fmt:float/.2" />
            <td class="amount"
                tal:content="view/total/upstream_bugs_delta" />
            <td class="amount"
                tal:content="view/total/watched_bugs" />
            <td class="amount"
                tal:content="view/total/watched_bugs_percentage/fmt:float/.2" />
            <td class="amount"
                tal:content="view/total/watched_bugs_delta" />
          </tr>
        </tfoot>
      </table>

      <div tal:condition="view/data" 
           align="right"><small>Top <span tal:content="view/data/count:len" />
        packages listed.</small></div>

    </div>

  </body>
</html>
