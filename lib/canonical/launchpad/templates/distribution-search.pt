<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad"
>
  <body>
    <metal:heading fill-slot="pageheading">
      <h1>Search results</h1>
    </metal:heading>

<div metal:fill-slot="main">

  <form name="search" method="GET">
    <div>
      <label for="text">
        Show <span tal:replace="context/title" /> packages containing:
      </label>
    </div>

    <input type="text" name="text" size="35"
      tal:attributes="value request/text|nothing" />

    <input type="submit" value="Search"
        tal:condition="not: view/search_requested" />

    <input type="submit" value="Search Again"
        tal:condition="view/search_requested" />
  </form>

  <br />

  <tal:search_requested condition="view/search_requested">

    <tal:batch define="batch view/batchnav/currentBatch">

      <tal:navigation replace="structure view/batchnav/@@+navigation-links-upper" />

      <ul class="sources" tal:condition="batch">
        <li tal:repeat="dsp batch">
          <a tal:attributes="href dsp/fmt:url;
                             title dsp/title"
             class="packagetitle"
             tal:content="dsp/title"/>
          <ul tal:condition="view/detailed">
            <li tal:repeat="pubrec dsp/current_publishing_records">
              <a tal:content="pubrec/distroseries/name"
                 tal:attributes="href pubrec/meta_sourcepackage/fmt:url;
                                 title pubrec/meta_sourcepackage/title" />
              (<span tal:replace="pubrec/section/name"/>):
              <a tal:content="pubrec/meta_sourcepackagerelease/version"
                 tal:attributes="href pubrec/meta_sourcepackagerelease/fmt:url;
                                 title pubrec/meta_sourcepackagerelease/title" />

              <div style="font-size: 80%;"
                   tal:define="meta_binaries 
                               pubrec/meta_distroseriessourcepackagerelease/meta_binaries">

                <tal:has_bin condition="meta_binaries">
                   Binary Packages:
                   <div id="binaries">
                     <tal:binaries repeat="bin meta_binaries">
                      <a id="binlink" tal:content="bin/name"
                         tal:attributes="href bin/fmt:url; title bin/title" />
                     </tal:binaries>
                   </div>
                </tal:has_bin>

                <tal:has_no_bin condition="not:meta_binaries">
                  <i>This package has no binaries</i>
                </tal:has_no_bin>

              </div>
            </li>
          </ul>
        </li>
      </ul>

      <tal:navigation replace="structure view/batchnav/@@+navigation-links-lower" />

      <tal:no_matches condition="not: view/matches">

        No packages matching '<span tal:replace="view/text">amarok</span>'
        are published in
        <span tal:replace="context/displayname">ubuntu</span>.

      </tal:no_matches>

    </tal:batch>

  </tal:search_requested>

</div>

</body>

</html>
