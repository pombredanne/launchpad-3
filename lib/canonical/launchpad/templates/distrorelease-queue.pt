<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template_2col/master"
      i18n:domain="launchpad">

<body>


<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-details" />
  <div tal:replace="structure context/distribution/@@+portlet-details" />
</metal:leftportlets>

<metal:heading fill-slot="pageheading">
  <h3 tal:content="context/title">Context title goes here</h3>
  <h1>Upload and build queue</h1>
</metal:heading>

<div metal:fill-slot="main"
     tal:define="message view/performQueueAction;
                 setup view/setupQueueList;
                 error view/error|nothing">

  <p class="informational message"
     tal:condition="message"
     tal:content="structure message">
     This call to view/performQueueAction actually parses the form and does
     the database queries based on actions posted (packages accepted or
     rejected), and shows the status of those actions here.
  </p>

  <p class="error message"
      tal:condition="error"
      tal:content="error"
  />


  <div class="queue_list" tal:condition="not: error">

    <tal:batch define="batch view/batchnav/currentBatch|nothing">

    <form name="queue_items_state" action="" method="GET">

      Show:

      <select name="queue_state" size="1">

        <option tal:repeat="option view/filtered_options"
                tal:attributes="selected option/selected;
                                value option/value"
                tal:content="option/name" />

      </select>

      uploads with names like:

      <input size="10" type="text" name="queue_text"
                       tal:attributes="value view/name_filter" />

      <input type="submit" value="Update" />

    </form>

    <br />

     <tal:navigation
          tal:condition="batch"
          replace="structure view/batchnav/@@+navigation-links" />

     <form name="queue_items_action" action="" method="POST">
     <table class="listing sortable" tal:condition="batch"
            id="distroreleasequeue">
       <thead>
         <tr>
           <th>
           </th>
           <th>
             Package
           </th>
           <th>
             Version
           </th>
           <th>
             Pocket
           </th>
           <th>
             Age
           </th>
           <th>
             Changes File
           </th>
         </tr>
       </thead>
       <tbody class="lesser">
         <tal:batch repeat="queue batch">
           <tr>
              <td class="icon left">
                 <input type="checkbox" name="QUEUE_ID"
                        tal:attributes="value queue/id"
                        tal:condition="view/availableActions"/>
              </td>
  	      <td>
                <span tal:replace="queue/displayname"/>
                <img tal:condition="queue/containsSource"
                     alt="[Source]" src="/@@/package-source" title="Source"/>
                <img tal:condition="queue/containsBuild"
                     alt="[Build]" src="/@@/package-binary" title="Binary"/>
                <img tal:condition="queue/containsInstaller"
                     alt="[Installer]" src="/@@/ubuntu-icon"
                     title="Installer"/>
                <img tal:condition="queue/containsTranslation"
                     alt="[Translation]" src="/@@/translations"
                     title="Translation"/>
                <img tal:condition="queue/containsUpgrader"
                     alt="[Upgrader]" src="/@@/topic_icon.gif"
                     title="Upgrader"/>
                <img tal:condition="queue/containsDdtp"
                     alt="[DDTP]" src="/@@/topic_icon.gif"
                     title="DDTP"/>
              </td>
              <td tal:content="queue/sourceversion">2.0.17-6</td>
              <td tal:content="queue/pocket/title">Updates</td>
              <td tal:content="queue/datecreated/fmt:datetime">
                2006-03-15
              </td>
              <td>[<a tal:attributes="
                href queue/changesfile/url">view</a>]
              </td>
           </tr>
         </tal:batch>
       </tbody>
     </table>

     <tal:has_items tal:condition="batch">
     <table class="listing" tal:condition="view/availableActions">
       <tfoot>
         <tr>
           <td colspan="6">
                 <input tal:repeat="action view/availableActions"
                        tal:attributes="value action; name action"
                        type="submit"/>
           </td>
         </tr>
       </tfoot>
     </table>
     </tal:has_items>

     </form>

     <div class="portalMessage" tal:condition="not: batch">
       The <span tal:replace="view/state/title" /> queue
       is empty.
     </div>

     <tal:navigation
          tal:condition="batch"
          replace="structure view/batchnav/@@+navigation-links" />

     </tal:batch>
  </div>

</div>

</body>
</html>
