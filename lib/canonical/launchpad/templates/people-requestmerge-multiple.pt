<tal:do-this-first tal:content="view/processForm" />
<html metal:use-macro="view/macro:page/pillarindex" i18n:domain="launchpad">
  <body>
    <h1 metal:fill-slot="heading">People and teams</h1>
    <div metal:fill-slot="main">
      <h1 tal:condition="not: view/dupe">No account found to merge</h1>
      <tal:duplicate condition="view/dupe">
        <tal:block tal:condition="not: view/form_processed">
          <h1>Merge accounts</h1>

      <p>
        The account <code tal:content="view/dupe/name">foo</code>,
        which you&#8217;re trying to merge,
        has more than one registered e-mail address.
        To complete the merge, you need to prove that you have access to
        all e-mail addresses registered for this account.
        To do this, select all of them and click <samp>Submit</samp>.
        If you don&#8217;t have access to one or more of these addresses,
        Launchpad will not be able to merge the account into your existing one,
        but any other addresses will be transferred to your account.
      </p>

      <form name="mergerequest" action="" method="POST">
      <input type="hidden" name="dupe" tal:attributes="value request/dupe" />
      <table>
        <tr tal:repeat="email view/dupeemails">
          <td>
            <input type="checkbox" name="selected" checked
                   tal:attributes="value email/email" />
          </td>
          <td tal:content="email/email">
          </td>
        </tr>
        <tr>
          <td colspan="2" align="right">
            <input type="submit" value="Submit" />
          </td>
        </tr>
      </table>
      </form>
    </tal:block>

    <tal:block tal:condition="view/form_processed">
      <h1>Confirmation mail sent</h1>

      <p>Individual email messages were sent to
        <tal:block repeat="email view/notified_addresses">
          <strong tal:content="email"
            /><span tal:condition="not: repeat/email/end">, </span>
        </tal:block>.
        Please follow the instructions on each of those messages to complete
        the merge.
      </p>
    </tal:block>

  </tal:duplicate>
</div> 

</body>
</html>

