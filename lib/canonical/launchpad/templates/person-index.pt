<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="context/@@main_template/master"
      i18n:domain="launchpad">

<head>
    <tal:block metal:fill-slot="head_epilogue">
      <tal:visible_emails condition="not: context/hide_email_addresses">
        <link rel="meta" type="application/rdf+xml" title="FOAF" href="+rdf"
              tal:condition="context/is_valid_person_or_team" />
      </tal:visible_emails>
    </tal:block>
</head>

<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-emails" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
  <div tal:replace="structure context/@@+portlet-details" />
  <div tal:replace="structure context/@@+portlet-working-on" />
  <div tal:replace="structure context/@@+portlet-latesttickets" />
</metal:rightportlets>

<div metal:fill-slot="main">

<tal:valid-person-or-team condition="context/is_valid_person_or_team">

  <h1 tal:content="context/browsername" />

  <img
    tal:condition="context/gotchi"
    tal:attributes="src context/gotchi/getURL"
    style="float: right; margin: 0 0 0.5em 0.5em"
    alt=""
  />
  <tal:homepage tal:condition="context/homepage_content"
                content="structure context/homepage_content/fmt:text-to-html">
     The person's homepage goes here.
  </tal:homepage>
  <tal:description condition="context/teamdescription">
    <b>About this team:</b>
    <span tal:replace="structure context/teamdescription/fmt:text-to-html">
      DESCRIPTION</span>
  </tal:description>

  <h2>Details</h2>

  <table>
    <tr tal:condition="context/allwikis">
      <th>Wiki:</th>
      <td>
        <span tal:repeat="wiki context/allwikis">
          <a tal:content="wiki/wikiname" 
             tal:attributes="href wiki/url"
           >WikiName</a><tal:block condition="not: repeat/wiki/end">,
           </tal:block>
        </span>
      </td>
    </tr>

    <tr tal:repeat="ircnick context/ircnicknames">
      <th>IRC:</th>
      <td><code style="font-size: 120%"
                tal:content="ircnick/nickname"/>
          on network <code style="font-size: 120%"
                           tal:content="ircnick/network" />
      </td>
    </tr> 

    <tr tal:condition="context/jabberids">
      <th>Jabber:</th>
      <td>
        <tal:block repeat="jabber context/jabberids">
          <span tal:replace="jabber/jabberid"
            /><span tal:condition="not: repeat/jabber/end">,</span>
        </tal:block>
      </td>
    </tr> 

    <tr tal:condition="context/gpgkeys">
      <th>OpenPGP keys:</th>
      <td>
        <tal:block repeat="key context/gpgkeys">
          <a tal:attributes="href key/keyserverURL">
            <span tal:replace="key/keyid"
              /></a><span tal:condition="not: repeat/key/end">,</span>
        </tal:block>
      </td>
    </tr>

    <tr tal:condition="context/sshkeys">
      <th>SSH Keys:</th>
      <td>
        <a href="+sshkeys">
          <span tal:replace="context/sshkeys/count">0</span> SSH key(s)
        </a>
      </td>
    </tr>

  </table>

  <tal:members condition="context/isTeam">

    <h2>Team members</h2>

    <p>
      There are <span tal:replace="context/active_member_count">15</span>
      direct members of the 
      "<span tal:replace="context/browsername">Ubuntu Members</span>" team,
      and <span tal:replace="context/all_member_count">23</span> people are
      members in total, directly and indirectly through other team
      memberships.
    </p>

    <ul>
      <tal:block repeat="membership context/activememberships">
        <li tal:condition="not: membership/person/isTeam">
          <a tal:content="membership/person/browsername"
             tal:attributes="href membership/person/fmt:url">Joe Soap</a>
          <tal:is_owner condition="membership/is_owner">
            (Owner)
          </tal:is_owner>
          <tal:is_not_owner condition="not: membership/is_owner">
            <tal:is_admin condition="membership/is_admin">
              (Administrator)
            </tal:is_admin>
          </tal:is_not_owner>
        </li>
      </tal:block>
    </ul>

    <h2>Relationship to other teams</h2>
    <tal:block define="
      subteams context/getSubTeams;
      superteams context/getSuperTeams
    ">
      <p tal:condition="python: not subteams and not superteams">
        None of the members of
        &#8220;<span tal:replace="context/browsername"/>&#8221;
        are teams,
        and nor is it a member of any other team.
      </p>
      <p tal:condition="python: superteams and not subteams">
        None of the members of
        &#8220;<span tal:replace="context/browsername"/>&#8221;
        are teams.
      </p>
      <tal:block condition="subteams">
        <p>
          These teams are members of
          &#8220;<span tal:replace="context/browsername"/>&#8221; (so the
          members of these teams are effectively also members of this one):
        </p>
        <ul>
          <li tal:repeat="team subteams">
            <a tal:attributes="href team/fmt:url"
               tal:content="team/browsername">name</a>
          </li>
        </ul>
      </tal:block>
      <p tal:condition="python: subteams and not superteams">
        &#8220;<span tal:replace="context/browsername"/>&#8221;
        itself is not a member of any other team.
      </p>
      <tal:block condition="superteams">
        <p>
          &#8220;<span tal:replace="context/browsername"/>&#8221;
          is a member of these teams:
        </p>
        <ul>
          <li tal:repeat="team superteams">
            <a tal:attributes="href team/fmt:url"
               tal:content="team/browsername">name</a>
          </li>
        </ul>
      </tal:block>
    </tal:block>
  </tal:members>

  <tal:memberships condition="not: context/isTeam">
    <tal:block condition="context/myactivememberships">
      <h2>Team memberships</h2>

      <p><span tal:replace="context/browsername">Foo Bar</span> is
        a member of:
      </p>
      <ul>
        <li class="person"
            tal:repeat="membership context/myactivememberships">
          <a tal:attributes="href membership/team/fmt:url"
             tal:content="membership/team/browsername">foo</a>
          (<span tal:replace="membership/statusname">
            Administrator</span>)
        </li>
      </ul>
    </tal:block>
    <p tal:condition="not: context/myactivememberships">
      <span tal:replace="context/browsername">Foo Bar</span> is not an
      active member of any Launchpad teams.
    </p>
  </tal:memberships>

  <tal:isteam condition="context/isTeam">
    <h2>Your involvement</h2>

    <p tal:condition="not: request/lp:person">
      You must <a href="+login">log in</a>
      to join or leave this team.
    </p>
    <tal:block condition="request/lp:person">
      <tal:block condition="view/userIsOwner">
        <p tal:condition="view/userIsActiveMember">
          You are the owner of this team.
        </p>
        <p tal:condition="not: view/userIsActiveMember">
          You are the owner of this team,
          but not currently an active member.
        </p>
      </tal:block>
      <tal:block condition="not: view/userIsOwner">
        <p tal:condition="view/userIsActiveMember">
          You are a member of this team.
        </p>
        <p tal:condition="not: view/userIsActiveMember">
          <tal:foo tal:condition="not: view/userIsParticipant">
            You are not a member of this team.
          </tal:foo>
          <tal:foo tal:condition="view/userIsParticipant">
            You are an indirect member of this team:
            <br />
            <a tal:attributes="href view/user/fmt:url"
               tal:content="view/user/displayname">
              Guilherme Salgado
            </a>
            <tal:path repeat="team view/findUserPathToTeam">
              -&gt;
              <a tal:attributes="href team/fmt:url"
                 tal:content="team/displayname">
                Launchpad Developers
              </a>
            </tal:path>
          </tal:foo>
        </p>
      </tal:block>
    </tal:block>
  </tal:isteam>

</tal:valid-person-or-team>

<tal:invalid-person condition="not: context/is_valid_person_or_team">
  <h1 tal:content="context/browsername" />

  <p><span tal:replace="context/browsername" /> does not use Launchpad.
    <tal:block condition="context/creation_comment">
      This page was created on
      <span tal:replace="context/datecreated/fmt:date" />
      <tal:user-created
        condition="context/creation_rationale/enumvalue:USER_CREATED">
        by <a tal:attributes="href context/registrant/fmt:url">
        <span tal:replace="context/registrant/browsername">Foo</span></a>,
        and the reason given by that user for its creation is:
        <em tal:content="structure context/creation_comment/fmt:text-to-html">
          reason</em>
      </tal:user-created>
      <tal:not-user-created
        condition="not: context/creation_rationale/enumvalue:USER_CREATED">
        <strong tal:content="context/creation_comment" />.
      </tal:not-user-created>
    </tal:block>
    <tal:block condition="not: context/creation_comment">
      (This page was created on 
      <span tal:replace="context/datecreated/fmt:date" />.)
    </tal:block>
  </p>

  <tal:logged-in condition="request/lp:person">
    <a tal:attributes="
      href string:/people/+requestmerge?field.dupeaccount=${context/name}"
    >Hey, I'm <span tal:replace="context/browsername" /></a>
  </tal:logged-in>

  <tal:not-logged-in condition="not: request/lp:person">
    <a href="+claim">Hey, I'm <span tal:replace="context/browsername" /></a>
  </tal:not-logged-in>

</tal:invalid-person>

</div> 
</body>
</html>
