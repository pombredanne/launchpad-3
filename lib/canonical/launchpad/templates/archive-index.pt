<html
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  xml:lang="en"
  lang="en"
  dir="ltr"
  metal:use-macro="view/macro:page/onecolumn"
  i18n:domain="launchpad"
  >
<body>

    <div metal:fill-slot="main"
         tal:define="ppa_active view/is_active">

      <tal:privacy replace="structure context/@@+portlet-privacy" />

      <h1 tal:content="CONTEXTS/fmt:pagetitle">PPA for user</h1>

      <div class="actions" style="float:right;">
        <tal:administer
          define="link context/menu:context/admin"
          condition="link/enabled"
          replace="structure link/render" />
        <tal:edit
          define="link context/menu:context/edit"
          condition="link/enabled"
          replace="structure link/render" />
        <tal:edit-dependencies
          define="link context/menu:context/edit_dependencies"
          condition="link/enabled"
          replace="structure link/render" />
      </div>

      <h2 style="margin-top: 0">
        URL:
        <a tal:condition="ppa_active"
           tal:attributes="href context/archive_url"
           tal:content="context/archive_url">url</a>
        <tal:no-link
           condition="not: ppa_active"
           content="context/archive_url">url</tal:no-link>
      </h2>

      <tal:whiteboard condition="context/required:launchpad.Edit">
         <div id="whiteboard" class="informational"
              tal:condition="context/whiteboard">
           <p>PPA whiteboard:</p>
           <tal:archive-whiteboard
              replace="structure context/whiteboard/fmt:text-to-html" />
         </div>
      </tal:whiteboard>

      <div id="description">
         <tal:archive-description condition="context/description"
            replace="structure context/description/fmt:text-to-html" />
      </div>

      <div tal:condition="ppa_active">

        <h2>apt sources.list entries</h2>

        <tal:entries replace="structure view/sources_list_entries" />

        <p id="signing-key"
	   tal:define="signing_key context/signing_key"
	   tal:condition="signing_key">
          This repository is signed with
          <a tal:attributes="href signing_key/keyserverURL">
            <code tal:content="signing_key/fingerprint">
              0123456789012345678901234567890123456789
            </code>
          </a> OpenPGP key.
          Follow <a href="https://help.launchpad.net/Packaging/PPA#Adding%20a%20PPA%20to%20your%20Ubuntu%20repositories">these instructions</a> if you want to
	  install packages from this PPA.
        </p>

      </div>

      <div id="ppa-dependencies" tal:condition="context/dependencies">

        <h3>PPA dependencies</h3>

        <ul>
           <li tal:repeat="dependency context/dependencies">
             <a tal:attributes="href dependency/dependency/fmt:url"
                tal:content="dependency/title" />
             (included <span
               tal:replace="dependency/date_created/fmt:displaydate" />)
           </li>
        </ul>

      </div> <!-- ppa-dependencies -->

      <h2>Packages</h2>

      <p tal:condition="not: ppa_active">
        This PPA does not contain any packages yet.
      </p>

      <tal:active_ppa condition="ppa_active">

      <!--Disabled section due to performance issues. -->
      <tal:contents tal:define="archive context"
                    tal:condition="python: False">
        <metal:package-counters
          use-macro="context/@@+macros/package-counters" />
      </tal:contents>
      <p id="package_counters" class="discreet">
        Package counters and estimated archive size temporarily unavailable.
      </p>

      <div class="actions" style="float:right;">
        <tal:builds
          define="link context/menu:context/builds"
          condition="link/enabled"
          replace="structure link/render" />
        <tal:copy
          define="link context/menu:context/copy"
          condition="link/enabled"
          replace="structure link/render" />
        <tal:delete
          define="link context/menu:context/delete"
          condition="link/enabled"
          replace="structure link/render" />
      </div>

      <div>
        <form name="package_search" action="" method="GET">
           <label for="name">Package name contains:</label>
           <input id="field.name_filter" title="Package Name" size="20"
                  type="text" name="field.name_filter"
                  tal:attributes="value request/field.name_filter|nothing"/>
           <tal:status_filter
             replace="structure view/plain_status_filter_widget" />
           <input type="submit" value="Search" />
        </form>
      </div>

      <div style="padding-top: 1em;" tal:define="batch view/search_results">

      <tal:navigation_top
           replace="structure view/batchnav/@@+navigation-links-upper" />

      <table class="listing" id="packages_list" tal:condition="batch">
        <thead>
          <tr class="ppa_package_row">
            <th colspan="2">Source</th>
            <th tal:condition="context/owner/isTeam">Uploader</th>
            <th>Published</th>
            <th>Status</th>
            <th>Series</th>
            <th>Section</th>
            <th>Build Status</th>
          </tr>
        </thead>
        <tbody>
          <tal:block repeat="publishing batch"
                     replace="structure publishing/@@+listing-ppa-detailed">
          </tal:block>
        </tbody>
      </table>

      <tal:navigation_bottom
           replace="structure view/batchnav/@@+navigation-links-lower" />

        <div id="empty-result"
             tal:define="name_filter request/field.name_filter|nothing"
             tal:condition="not: batch">
           No matching package for '<tal:name_filter replace="name_filter" />'.
        </div>

      </div>

      </tal:active_ppa>

    </div> <!--main -->

  </body>
</html>
