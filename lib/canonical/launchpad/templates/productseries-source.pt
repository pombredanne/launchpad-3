<html metal:use-macro="view/macro:page/default" i18n:domain="bazaar">
<body>

<metal:leftportlets fill-slot="portlets_one">
  <div tal:replace="structure context/@@+portlet-details" />
  <div tal:replace="structure context/product/@@+portlet-details" />
</metal:leftportlets>

<metal:rightportlets fill-slot="portlets_two">
</metal:rightportlets>

<metal:heading fill-slot="pageheading">
  <h1>Upstream source import</h1>
</metal:heading>

<div metal:fill-slot="main">

  <div metal:use-macro="context/@@launchpad_form/form">
    <p metal:fill-slot="extra_info" tal:condition="not:view/errors">
      Once you enter the details of the
      <abbr title="revision control system">RCS</abbr> you use for
      this release series, Launchpad Administrators will attempt to import that
      code and publish it as a Bazaar branch.
    </p>

    <metal:formbody fill-slot="widgets">

      <div class="formHelp">
        Enter details below for only the selected Repository type.
      </div>

      <fieldset>
        <legend>
          <label>
            <input tal:replace="structure view/rcstype_none" />
            No revision control system, or Bazaar
          </label>
        </legend>
        <table class="form">
          <tal:widget define="widget nocall:view/widgets/user_branch">
            <metal:block use-macro="context/@@launchpad_form/widget_row" />
          </tal:widget>
        </table>
      </fieldset>

      <fieldset>
        <legend>
          <label>
            <input tal:replace="structure view/rcstype_cvs" />
            CVS
          </label>
        </legend>
        <table class="form">
          <tal:widget define="widget nocall:view/widgets/cvsroot">
            <metal:block use-macro="context/@@launchpad_form/widget_row" />
          </tal:widget>
          <tal:widget define="widget nocall:view/widgets/cvsmodule">
            <metal:block use-macro="context/@@launchpad_form/widget_row" />
          </tal:widget>
          <tal:widget define="widget nocall:view/widgets/cvsbranch">
            <metal:block use-macro="context/@@launchpad_form/widget_row" />
          </tal:widget>
        </table>
      </fieldset>

      <fieldset>
        <legend>
          <label>
            <input tal:replace="structure view/rcstype_svn" />
            Subversion
          </label>
        </legend>

        <table class="form">
          <tal:widget define="widget nocall:view/widgets/svnrepository">
            <metal:block use-macro="context/@@launchpad_form/widget_row" />
          </tal:widget>
        </table>
      </fieldset>

      <input tal:replace="structure view/rcstype_emptymarker" />

      <tal:has-import-status condition="context/importstatus">
        <h2>Import Status</h2>
        <p>The current import status is:
          <b tal:content="context/importstatus/title">$title</b>. </p>
      </tal:has-import-status>

      <script type="text/javascript">
        function updateWidgets() {
          /* which rcs type radio button has been selected? */
          var rcstypes = document.getElementsByName('field.rcstype');
          var form = rcstypes[0].form;
          var rcstype = 'None';
          for (var i = 0; i < rcstypes.length; i++) {
            if (rcstypes[i].checked) {
              rcstype = rcstypes[i].value;
              break;
            }
          }
          form['field.cvsroot'].disabled = (rcstype != 'CVS');
          form['field.cvsbranch'].disabled = (rcstype != 'CVS');
          form['field.cvsmodule'].disabled = (rcstype != 'CVS');
          form['field.svnrepository'].disabled = (rcstype != 'SVN');
        }
        updateWidgets();
      </script>

    </metal:formbody>
  </div>

</div>
</body>
</html>
<!-- 1-0 in-progress -->
