= Breadcrumbs and site menu =

We are using Dynarch menus to display the heirarchy breadcrumbs and the
pop-up site map.

There is a Breadcrumbs view class that takes care of rendering the appropriate
<ul> elements that Dynarch will convert into menus.

    >>> from canonical.launchpad.browser import Breadcrumbs

We need a request object that has a request.breadcrumbs attribute, which is
a list of Breadcrumb objects.  Each crumb object has a crumb.url and crumb.text
attribute.

    >>> from canonical.launchpad.webapp.publisher import Breadcrumb

    >>> class Request(object):
    ...
    ...     def __init__(self):
    ...         self.breadcrumbs = []
    ...
    ...     def addCrumb(self, url, text, has_menu=True):
    ...         self.breadcrumbs.append(Breadcrumb(url, text, has_menu))
    ...
    ...     def clearCrumbs(self):
    ...         self.breadcrumbs[:] = []

    >>> request = Request()
    >>> context = whatever = object()
    >>> def render_breadcrumbs():
    ...     print Breadcrumbs(context, request).render()


With no breadcrumbs, we get a single <li> element for Launchpad, containing
the sitemap.  The URL of the mainsite is hardcoded for the first breadcrumb.

    >>> render_breadcrumbs()
    <li lpm:mid="root" class="item"><a href="http://launchpad.dev/" class="breadcrumb container" id="homebreadcrumb"><em><span>Home</span></em></a></li>


When we add a breadcrumb, it appears as a top level <li> after the
initial "Launchpad" <li>.  Note that this one is defined as not having a menu,
so its CSS class doesn't contain the text "container".

    >>> request.addCrumb('http://localhost/people', 'People', has_menu=False)
    >>> render_breadcrumbs()
    <li lpm:mid="root" class="item"><a href="http://launchpad.dev/" class="breadcrumb container" id="homebreadcrumb"><em><span>Home</span></em></a></li>
    <li class="item"><a href="http://localhost/people" class="breadcrumb"><em>People</em></a></li>


When we add another breadcrumb, it appears as a top level <li> after the
other two <li> elements.

    >>> request.addCrumb('http://localhost/people/someone', 'Someone')
    >>> render_breadcrumbs()
    <li lpm:mid="root" class="item"><a href="http://launchpad.dev/" class="breadcrumb container" id="homebreadcrumb"><em><span>Home</span></em></a></li>
    <li class="item"><a href="http://localhost/people" class="breadcrumb"><em>People</em></a></li>
    <li class="item" lpm:mid="http://localhost/people/someone/+menudata"><a href="http://localhost/people/someone" class="breadcrumb container"><em>Someone</em></a></li>

