  Play with 'name16's wikinames.

  First we check existing wikinames.

  >>> browser.addHeader('Authorization', 'Basic foo.bar@canonical.com:test')
  >>> browser.open('http://localhost/~name16/+editwikinames')
  >>> print browser.contents
  <...
  ...Ubuntu Wiki name...
  ...https://wiki.ubuntu.com/...
  ...FooBar...
  ...


  Now we try to add another WikiName with the Ubuntu wiki URL, but this is not
  allowed.

  >>> browser.getControl(name='newwiki').value = 'https://wiki.ubuntu.com/'
  >>> browser.getControl(name='newwikiname').value = 'FooBar2'
  >>> browser.getControl('Save Changes').click()
  >>> browser.url
  'http://localhost/~name16/+editwikinames'
  >>> print browser.contents
  <...
  ...You cannot have two Ubuntu WikiNames...
  ...


  Now we try to add a WikiName that is already registered in Launchpad.

  >>> browser.getControl(name='newwiki').value = 'https://wiki.ubuntu.com/'
  >>> browser.getControl(name='newwikiname').value = 'GuilhermeSalgado'
  >>> browser.getControl('Save Changes').click()
  >>> browser.url
  'http://localhost/~name16/+editwikinames'
  >>> print browser.contents
  <...
  ...The WikiName https://wiki.ubuntu.com/GuilhermeSalgado is already
  registered by ...
  ...


  Trying to add a new WikiName with a blank URL will not work.

  >>> browser.getControl(name='newwiki').value = ''
  >>> browser.getControl(name='newwikiname').value = 'FooBar'
  >>> browser.getControl('Save Changes').click()
  >>> browser.url
  'http://localhost/~name16/+editwikinames'
  >>> print browser.contents
  <...
  ...Neither Wiki nor WikiName can be empty....
  ...


  Now we finally manage to add a WikiName. :)

  >>> browser.getControl(name='newwiki').value = 'http://foo.bar/wiki/'
  >>> browser.getControl(name='newwikiname').value = 'FooBar'
  >>> browser.getControl('Save Changes').click()
  >>> browser.url
  'http://localhost/~name16/+editwikinames'

  This new wiki is added in 'Other wiki names' section.

  >>> import re
  >>> from BeautifulSoup import BeautifulSoup
  >>> soup = BeautifulSoup(browser.contents)
  >>> other_wiki_names_row = soup.first(
  ...     'h2', text='Other wiki names').findParent('tr')
  >>> wiki_input = other_wiki_names_row.findNext(
  ...   'input', attrs={'name': re.compile(r'wiki_\d+')})
  >>> print wiki_input['value']
  http://foo.bar/wiki/
  >>> wikiname_input = other_wiki_names_row.findNext(
  ...   'input', attrs={'name': re.compile(r'wikiname_\d+')})
  >>> print wikiname_input['value']
  FooBar

  # Save them for later user.
  >>> wiki_input_id = wiki_input['name']
  >>> wikiname_input_id = wikiname_input['name']

  Let's try to add it again, to see if it's possible to have two identical
  wikinames.

  >>> browser.getControl(name='newwiki').value = 'http://foo.bar/wiki/'
  >>> browser.getControl(name='newwikiname').value = 'FooBar'
  >>> browser.getControl('Save Changes').click()
  >>> browser.url
  'http://localhost/~name16/+editwikinames'
  >>> for message in find_tags_by_class(browser.contents, 'message'):
  ...     print message.renderContents()
  The WikiName http://foo.bar/wiki/FooBar already belongs to you.

  But the url/wikiname was wrong, so I'll fix it now.

  >>> browser.getControl(name=wiki_input_id).value = (
  ...     'http://foo.bar.com/wiki/')
  >>> browser.getControl(name=wikiname_input_id).value = 'FooBar2'
  >>> browser.getControl('Save Changes').click()
  >>> browser.url
  'http://localhost/~name16/+editwikinames'

  >>> soup = BeautifulSoup(browser.contents)
  >>> print soup.first('input', attrs=dict(name=wiki_input_id))['value']
  http://foo.bar.com/wiki/
  >>> print soup.first('input', attrs=dict(name=wikiname_input_id))['value']
  FooBar2

  Now remove the recently added WikiName.

  >>> browser.getControl('Remove').selected = True
  >>> browser.getControl('Save Changes').click()
  >>> browser.url
  'http://localhost/~name16/+editwikinames'

  And make sure it's not in the database anymore.

  >>> from canonical.launchpad.database import WikiNameSet
  >>> wiki = WikiNameSet().getByWikiAndName('http://foo.bar.com/wiki/', 'FooBar')
  >>> wiki is None
  True

