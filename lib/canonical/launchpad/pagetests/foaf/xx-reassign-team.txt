= Changing the owner of teams =

We allow the team owner (and only the team owner) to reassign it to any
launchpad user or team.

    >>> browser.addHeader(
    ...     'Authorization', 'Basic daf@canonical.com:test')
    >>> browser.open(
    ...     'http://launchpad.dev/~landscape-developers/+reassign')
    Traceback (most recent call last):
    ...
    Unauthorized: ...

    >>> from zope.testbrowser.testing import Browser
    >>> browser = Browser()
    >>> browser.handleErrors = False
    >>> browser.addHeader(
    ...     'Authorization', 'Basic test@canonical.com:test')

    >>> browser.open('http://launchpad.dev/~landscape-developers')
    >>> browser.getLink('Change owner').click()
    >>> browser.url
    'http://launchpad.dev/~landscape-developers/+reassign'

    >>> browser.getControl(name='field.owner').value = 'no-priv'
    >>> browser.getControl(name='existing').value = ['existing']
    >>> browser.getControl('Change Registrant').click()

Now we can see the new owner and also the old owner which has been made an
administrator of the team.

    >>> browser.url
    'http://launchpad.dev/~landscape-developers/'
    >>> print extract_text(
    ...     find_tag_by_id(browser.contents, 'membership-summary'))
    Team and membership summary
    Team owner: No Privileges Person
    Membership: 2 (Moderated Team)

    >>> browser.open('http://launchpad.dev/~landscape-developers/+members')
    >>> print extract_text(find_tag_by_id(browser.contents, 'activemembers'))
    Name   Member since   Expires   Status
    No Privileges Person   ...   Administrator
    Sample Person   ...   Administrator

Now Sample Person can't change the owner anymore.

    >>> browser.getLink('Change owner').click()
    Traceback (most recent call last):
    ...
    LinkNotFoundError
    >>> browser.open('http://launchpad.dev/~landscape-developers/+reassign')
    Traceback (most recent call last):
    ...
    Unauthorized: ...
    
But no-priv can.

    >>> browser = Browser()
    >>> browser.addHeader(
    ...     'Authorization', 'Basic no-priv@canonical.com:test')
    >>> browser.open('http://launchpad.dev/~landscape-developers')
    >>> browser.getLink('Change owner').click()
    >>> browser.url
    'http://launchpad.dev/~landscape-developers/+reassign'

    >>> browser.getControl(name='field.owner').value = 'ubuntu-team'
    >>> browser.getControl(name='existing').value = ['existing']
    >>> browser.getControl('Change Registrant').click()

    >>> browser.url
    'http://launchpad.dev/~landscape-developers/'
    >>> print extract_text(
    ...     find_tag_by_id(browser.contents, 'membership-summary'))
    Team and membership summary
    Team owner: Ubuntu Team
    Membership: 11 (Moderated Team)

    >>> browser.open('http://launchpad.dev/~landscape-developers/+members')
    >>> print extract_text(find_tag_by_id(browser.contents, 'activemembers'))
    Name   Member since   Expires   Status
    No Privileges Person   ...   Administrator
    Sample Person   ...   Administrator
    Ubuntu Team   ...   Administrator
