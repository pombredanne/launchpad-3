= Deleting product releases =

The main page of a product series includes a list of releases of that series.
When the user has launchpad.Edit rights on any of the releases, there will
be a link to a page where that release can be deleted.

    >>> user_browser.open('http://launchpad.dev/firefox/trunk')
    >>> print extract_text(find_tag_by_id(
    ...     user_browser.contents, 'series-details'))
    The "trunk" series represents the primary line of development...
    >>> print extract_text(find_tag_by_id(
    ...     user_browser.contents, 'series_trunk'))
    Version     Codename    Date Released
    0.9.2...
    0.9.1...
    0.9...

A user without the necessary rights won't see the links and won't be able
to see the +delete page.

    >>> user_browser.getLink(url='/firefox/trunk/0.9.2/+delete')
    Traceback (most recent call last):
    ...
    LinkNotFoundError
    >>> user_browser.open('http://launchpad.dev/firefox/trunk/0.9.2/+delete')
    Traceback (most recent call last):
    ...
    Unauthorized:...

Salgado has the necessary rights, so he sees the link and the +delete page.

    >>> salgados_browser = setupBrowser(auth='Basic salgado@ubuntu.com:zeca')
    >>> salgados_browser.open('http://launchpad.dev/firefox/trunk')
    >>> salgados_browser.getLink(url='/firefox/trunk/0.9.2/+delete').click()
    >>> print salgados_browser.title
    Delete Mozilla Firefox 0.9.2...

The 0.9.2 release has some files associated with it, so it can't be deleted.

    >>> print extract_text(find_main_content(salgados_browser.contents))
    This release cannot be deleted...
    >>> salgados_browser.getControl('Yes, Delete it')
    Traceback (most recent call last):
    ...
    LookupError:...

If the release had no files associated with it, we'd be able to delete it.

    >>> salgados_browser.open('http://launchpad.dev/firefox/trunk')
    >>> salgados_browser.getLink(url='/firefox/trunk/0.9.1/+delete').click()
    >>> print salgados_browser.title
    Delete Mozilla Firefox 0.9.1...
    >>> salgados_browser.getControl('Yes, Delete it').click()
    >>> print salgados_browser.title
    Overview of Mozilla Firefox Series: trunk
    >>> msgs = get_feedback_messages(salgados_browser.contents)
    >>> print "\n".join(msg for msg in msgs)
    Release 0.9.1 deleted.
