Only the bug contact, or a user with launchpd.Edit on the respective
product or distro, can edit Importance.

    >>> from zope.component import getUtility

    >>> from canonical.database.sqlbase import flush_database_updates
    >>> from canonical.launchpad.ftests import login, logout
    >>> from canonical.launchpad.interfaces import (
    ...     IPersonSet, IProductSet, IDistributionSet)

    >>> login("foo.bar@canonical.com")

    >>> personset = getUtility(IPersonSet)
    >>> no_priv = personset.getByName("no-priv")
    >>> sabdfl = personset.getByName("sabdfl")
    >>> firefox = getUtility(IProductSet).getByName("firefox")
    >>> ubuntu = getUtility(IDistributionSet).getByName("ubuntu")
    >>> logout()

    >>> def user_sees_importance_widget(user, url):
    ...     browser = setupBrowser(
    ...         "Basic %s:test" % user.preferredemail.email)
    ...     browser.open(url)
    ...     try:
    ...         browser.getControl("Importance")
    ...     except LookupError:
    ...         return False
    ...     else:
    ...         return True

For a product bug contact.

    >>> login("foo.bar@canonical.com")
    >>> firefox.bugcontact = no_priv
    >>> flush_database_updates()
    >>> logout()

    >>> user_sees_importance_widget(
    ...     user=no_priv,
    ...     url="http://localhost:9000/firefox/+bug/1/+editstatus")
    True

For a product owner.

    >>> print firefox.owner.name
    name12

    >>> login("foo.bar@canonical.com")
    >>> sample_person = personset.getByName("name12")
    >>> logout()

    >>> user_sees_importance_widget(
    ...     user=sample_person,
    ...     url="http://localhost:9000/firefox/+bug/1/+editstatus")
    True

For someone else. We'll unset no_priv as the bug contact, and note that
he can no longer see the widget.

    >>> login("foo.bar@canonical.com")
    >>> firefox.bugcontact = None
    >>> flush_database_updates()
    >>> logout()

    >>> user_sees_importance_widget(
    ...     user=no_priv,
    ...     url="http://localhost:9000/firefox/+bug/1/+editstatus")
    False

For a distribution bug contact.

    >>> login("foo.bar@canonical.com")
    >>> ubuntu.bugcontact = no_priv
    >>> flush_database_updates()
    >>> logout()

    >>> user_sees_importance_widget(
    ...     user=no_priv,
    ...     url="http://localhost:9000/ubuntu/+source/mozilla-firefox/+bug/1/+editstatus")
    True

For a distribution owner.

    >>> login("foo.bar@canonical.com")
    >>> sabdfl.inTeam(ubuntu.owner)
    True
    >>> logout()

    >>> user_sees_importance_widget(
    ...     user=sabdfl,
    ...     url="http://localhost:9000/ubuntu/+source/mozilla-firefox/+bug/1/+editstatus")
    True

For someone else, on Ubuntu.

    >>> login("foo.bar@canonical.com")
    >>> ubuntu.bugcontact = None
    >>> flush_database_updates()
    >>> logout()

    >>> user_sees_importance_widget(
    ...     user=no_priv,
    ...     url="http://localhost:9000/ubuntu/+source/mozilla-firefox/+bug/1/+editstatus")
    False
