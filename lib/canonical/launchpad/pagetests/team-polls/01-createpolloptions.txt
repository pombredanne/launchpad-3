  Let's add a new option for the dpl-2080 poll we've just created.

  >>> team_admin_browser = setupBrowser(
  ...     auth='Basic jeff.waugh@ubuntulinux.com:jdub')
  >>> team_admin_browser.open(
  ...     'http://launchpad.dev/~ubuntu-team/+poll/dpl-2080')
  >>> team_admin_browser.getLink('Add new option').click()
  >>> team_admin_browser.url
  'http://launchpad.dev/~ubuntu-team/+poll/dpl-2080/+newoption'

  >>> 'Add a poll option' in team_admin_browser.contents
  True

  And now, actually add the option.

  >>> bill_name = (
  ...     'bill-amazingly-huge-middle-name-almost-impossible-to-read-graham')
  >>> team_admin_browser.getControl('Name').value = bill_name
  >>> team_admin_browser.getControl('Title').value = 'Bill Graham'
  >>> team_admin_browser.getControl('Add').click()

  We're redirected to the poll page

  >>> team_admin_browser.url
  'http://launchpad.dev/~ubuntu-team/+poll/dpl-2080'


  And here we see the option listed as one of the active options for this
  poll.
q
  >>> team_admin_browser.getLink('Show option details').click()
  >>> team_admin_browser.url
  'http://launchpad.dev/~ubuntu-team/+poll/dpl-2080/+options'

  >>> 'Poll options' in team_admin_browser.contents
  True
  >>> bill_name in team_admin_browser.contents
  True

  If we try to add a new option without providing a title, we'll get an error
  message because the title is required.

  >>> team_admin_browser.getLink('Add new option').click()
  >>> team_admin_browser.url
  'http://launchpad.dev/~ubuntu-team/+poll/dpl-2080/+newoption'

  >>> will_name = (
  ...     'will-amazingly-huge-middle-name-almost-impossible-to-read-graham')
  >>> team_admin_browser.getControl('Name').value = will_name
  >>> team_admin_browser.getControl('Title').value = ''
  >>> team_admin_browser.getControl('Add').click()

  >>> 'Required input is missing' in team_admin_browser.contents
  True

  If we try to add a new option with the same name of a existing option, we
  should get a nice error message

  >>> team_admin_browser.getControl('Name').value = bill_name
  >>> team_admin_browser.getControl('Title').value = 'Bill Again'
  >>> team_admin_browser.getControl('Add').click()

  >>> message = (
  ...     "%s is already in use by another option in this poll" % bill_name)
  >>> message in team_admin_browser.contents
  True

  It's not possible to add/edit a poll option after a poll is open or closed.
  That's only possible when the poll is not yet open.

  >>> team_admin_browser.open(
  ...     'http://launchpad.dev/~ubuntu-team/+poll/director-2004/+newoption')

  >>> message = (
  ...     "You can&#8217;t add new options because the poll is already "
  ...     "closed.")
  >>> message in team_admin_browser.contents
  True

  >>> team_admin_browser.open(
  ...     'http://launchpad.dev/~ubuntu-team/+poll/never-closes/+newoption')
  >>> message = (
  ...     "You can&#8217;t add new options because the poll is already open.")
  >>> message in team_admin_browser.contents
  True
