= Appointing translators in a translation group =

No translators have been appointed in the polyglot group so far.

A user can have rights to appoint or remove members on any of three grounds:
owning the group, being a Rosetta expert, or being a Launchpad administrator.

Jordi Mallach, is a Rosetta administrator ("expert").  He does not own polyglot
nor is he a Launchpad adminstrator.  That is enough to allow him to appoint a
translator.

  >>> browser.addHeader('Authorization', 'Basic jordi@ubuntu.com:test')
  >>> browser.open(
  ...   'http://translations.launchpad.dev/+groups/polyglot/')
  >>> print find_portlet(browser.contents, 'Translation Teams')
  <...
  There are no translators appointed in this group yet.
  ...

Verify that the appointments form displays, and offers the option to appoint
a translator.

  >>> browser.getLink('Appoint').click()
  >>> browser.url
  'http://translations.launchpad.dev/+groups/polyglot/+appoint'

Appoint a translator. Hoary Gnome Team will translate into Abkhazian.

  >>> browser.getControl('Language').value=['ab']
  >>> browser.getControl('Translator').value='name21'
  >>> browser.getControl('Add').click()

We should get redirected back to the group page.

  >>> browser.url
  'http://translations.launchpad.dev/+groups/polyglot'

  >>> browser.getLink('Appoint').click()
  >>> browser.url
  'http://translations.launchpad.dev/+groups/polyglot/+appoint'

And let's appoint No Privileges user for Afrikaans too.

  >>> browser.getControl('Language').value=['af']
  >>> browser.getControl('Translator').value='no-priv'
  >>> browser.getControl('Add').click()

Now we should see both of those appointments on the polyglot page:

  >>> find_main_content(browser.contents)
  <...Abkhazian...Hoary Gnome Team...
  ...Afrikaans...No Privileges Person...

  >>> browser.url
  'http://translations.launchpad.dev/+groups/polyglot'

Appointing a new Abkhazian translator must fail gracefully, not crash as
it used to do (Bug #52991).

  >>> browser.getLink('Appoint').click()
  >>> browser.getControl('Language').value=['ab']
  >>> browser.getControl('Translator').value='name12'
  >>> browser.getControl('Add').click()

The error means we stay on the appoint page:

  >>> browser.url
  'http://translations.launchpad.dev/+groups/polyglot/+appoint'

  >>> for message in find_tags_by_class(browser.contents, 'message'):
  ...     print message.renderContents()
  There is 1 error.
  There is already a translator for this language

Launchpad administrators, are allowed too to manage translation group
membership.

  >>> admin_browser.open(
  ...   'http://translations.launchpad.dev/+groups/polyglot/')
  >>> admin_browser.getLink('Appoint').click()
  >>> admin_browser.url
  'http://translations.launchpad.dev/+groups/polyglot/+appoint'

Even to edit details of the translation group.

  >>> admin_browser.open(
  ...   'http://translations.launchpad.dev/+groups/polyglot/')
  >>> admin_browser.getLink('Edit translation group details').click()
  >>> admin_browser.url
  'http://translations.launchpad.dev/+groups/polyglot/+edit'

Normal users, however, are not.

  >>> user_browser.open(
  ...   'http://translations.launchpad.dev/+groups/polyglot/')
  >>> user_browser.url
  'http://translations.launchpad.dev/+groups/polyglot/'
  >>> user_browser.getLink('Appoint').click()
  Traceback (most recent call last):
  ...
  Unauthorized:...
  >>> user_browser.open(
  ...   'http://translations.launchpad.dev/+groups/polyglot/')
  >>> user_browser.url
  'http://translations.launchpad.dev/+groups/polyglot/'
  >>> user_browser.getLink('Edit translation group details').click()
  Traceback (most recent call last):
  ...
  Unauthorized:...
