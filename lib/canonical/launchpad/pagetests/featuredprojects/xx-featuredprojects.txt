
= Featured Projects =

We maintain a list of featured projects, which are displayed on the home
page and managed via a special admin-only page.

   >>> MANAGE_LINK = "Manage featured project list"


== The home page listing ==

Featured projects are visible to everyone on the home page:

    >>> anon_browser.open('http://launchpad.dev/')
    >>> featured = find_tag_by_id(anon_browser.contents, 'featured-projects')
    >>> print extract_text(featured.h2)
    Featured projects

We show the featured projects in our sample data:

    >>> for link in featured.findAll('a'):
    ...     print extract_text(link)
    Gnome Applets
    Bazaar
    Mozilla Firefox
    Gentoo
    GNOME
    GNOME Terminal
    the Mozilla Project
    Mozilla Thunderbird
    Ubuntu


== Adding a featured project ==

Anonymous users cannot see the link to administer featured projects:

    >>> anon_browser.getLink(MANAGE_LINK)
    Traceback (most recent call last):
    ...
    LinkNotFoundError

A user without privileges cannot see the administration link, either:

    >>> nopriv_browser = setupBrowser(auth="Basic no-priv@canonical.com:test")
    >>> nopriv_browser.open('http://launchpad.dev/')
    >>> nopriv_browser.getLink(MANAGE_LINK)
    Traceback (most recent call last):
    ...
    LinkNotFoundError

But Foo Bar, who is an administrator, can see the management link:

    >>> admin_browser.open('http://launchpad.dev/')
    >>> admin_browser.getLink(MANAGE_LINK).click()
    >>> admin_browser.url
    'http://launchpad.dev/+featuredprojects'

No Privilege persons is denied access to this page:

    >>> nopriv_browser.open('http://launchpad.dev/+featuredprojects')
    Traceback (most recent call last):
    ...
    Unauthorized: ...

Administrators can add a project. Here Foo Bar adds apache as a featured
project:

    >>> admin_browser.getControl('Add project').value = 'apache'
    >>> admin_browser.getControl('Update').click()
    >>> admin_browser.url
    'http://launchpad.dev/'
    >>> featured = find_tag_by_id(admin_browser.contents, 'featured-projects')
    >>> 'Apache' in extract_text(featured)
    True


Just to be certain, we will iterate the list as we did before and see
that Apache has been added:

    >>> anon_browser.open('http://launchpad.dev/')
    >>> featured = find_tag_by_id(anon_browser.contents, 'featured-projects')
    >>> for link in featured.findAll('a'):
    ...     print extract_text(link)
    Apache
    Gnome Applets
    Bazaar
    Mozilla Firefox
    Gentoo
    GNOME
    GNOME Terminal
    the Mozilla Project
    Mozilla Thunderbird
    Ubuntu



== Removing a project ==

    >>> admin_browser.getLink(MANAGE_LINK).click()
    >>> admin_browser.getControl('Apache').click()
    >>> admin_browser.getControl('Update').click()
    >>> admin_browser.url
    'http://launchpad.dev/'
    >>> featured = find_tag_by_id(admin_browser.contents, 'featured-projects')
    >>> 'Apache' in extract_text(featured)
    False

Just to be certain, we will iterate the list as we did before and see
that Apache has been removed:

    >>> anon_browser.open('http://launchpad.dev/')
    >>> featured = find_tag_by_id(anon_browser.contents, 'featured-projects')
    >>> for link in featured.findAll('a'):
    ...     print extract_text(link)
    Gnome Applets
    Bazaar
    Mozilla Firefox
    Gentoo
    GNOME
    GNOME Terminal
    the Mozilla Project
    Mozilla Thunderbird
    Ubuntu


