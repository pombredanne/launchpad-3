== Distribution Packaging ==

The packaging records for a source package in a given distribution are
displayed on the page of the distribution source package.

    >>> anon_browser.open('http://launchpad.dev/ubuntu/+source/alsa-utils')

This page includes a table that lists all the releases of this source
package in this distribution, and the packaging associations for this
source package in each series of this distribution.

If there are multiple releases in a distroseries, the values that are
identical are not repeated.
 
    >>> content = anon_browser.contents
    >>> print extract_text(find_tag_by_id(content, 'packaging'))
    Ubuntu version                                 Upstream version
    hoary development main release 1.0.9a-4ubuntu1 None defined
    warty current     main release 1.0.9a-4        alsa-utils Series: trunk
                      main         1.0.8-1ubuntu1


=== Delete Link Button ===

A button is displayed to authenticated users to delete existing
packaging links.

    >>> user_browser.open('http://launchpad.dev/ubuntu/+source/alsa-utils')
    >>> form = user_browser.getForm("delete_warty_alsa-utils_trunk")
    >>> print form.getControl("Delete Link")
    <SubmitControl name='field.actions.delete_packaging' type='submit'>

This button is not displayed to anonymous users.

    >>> anon_browser.open('http://launchpad.dev/ubuntu/+source/alsa-utils')
    >>> anon_browser.getForm("delete_warty_alsa-utils_trunk")
    Traceback (most recent call last):
    ...
    LookupError

Clicking this button deletes the corresponding packaging association.

    >>> form = user_browser.getForm("delete_warty_alsa-utils_trunk")
    >>> form.getControl("Delete Link").click()
    >>> content = user_browser.contents
    >>> for tag in find_tags_by_class(content, 'error'):
    ...     print extract_text(tag)
    >>> for tag in find_tags_by_class(content, 'informational'):
    ...     print extract_text(tag)
    Removed upstream association between alsa-utils trunk and Warty.
    >>> print extract_text(find_tag_by_id(content, 'packaging'))
    Ubuntu version                                 Upstream version
    hoary development main release 1.0.9a-4ubuntu1 None defined
    warty current     main release 1.0.9a-4        None defined
                      main         1.0.8-1ubuntu1


== Multiple package links ==

It is possible for multiple product series to be linked to the same
sourcepackage. When this is the case, only the latest is displayed and
will be deleted.

(Link evolution source package to a new series.)

    >>> admin_browser.open('http://launchpad.dev/evolution/+addseries')
    >>> admin_browser.getControl('Name').value = 'no-crashes'
    >>> admin_browser.getControl('Summary').value = (
    ...     'The series that everybody is waiting for!')
    >>> admin_browser.getControl('Register Series').click()

    >>> user_browser.open(
    ...     'http://launchpad.dev/evolution/no-crashes/+ubuntupkg')
    >>> user_browser.getControl(name='ubuntupkg').value = 'evolution'
    >>> user_browser.getControl('Update').click()


When the user visits the source package page, only the latest link is
displayed:

    >>> user_browser.open(
    ...     'http://launchpad.dev/ubuntu/+source/evolution')
    >>> print extract_text(find_tag_by_id(user_browser.contents, 'packaging'))
    Ubuntu version                     Upstream version
    hoary development main release 1.0 Evolution Series: no-crashes

Once he deletes the link, the older link shows:

    >>> form = user_browser.getForm("delete_hoary_evolution_no-crashes")
    >>> form.getControl("Delete Link").click()
    >>> for message in get_feedback_messages(user_browser.contents):
    ...     print message
    Removed upstream association between Evolution no-crashes and Hoary.

    >>> print extract_text(find_tag_by_id(user_browser.contents, 'packaging'))
    Ubuntu version                     Upstream version
    hoary development main release 1.0 Evolution Series: trunk
