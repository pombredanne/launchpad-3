The bug index page includes an actions portlet, which provides various
links to add things to the bug.

  >>> print http(r"""
  ... GET /distros/debian/+source/mozilla-firefox/+bug/3 HTTP/1.1
  ... """)
  HTTP/1.1 200 Ok
  ...
  ...Mark as Duplicate...
  ...Activity Log...
  ...

  Tests the marking of a bug that is a duplicate of a duplicate.

  >>> print http(r"""
  ... POST /products/ubuntu/+bug/1/+duplicate HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: multipart/form-data; boundary=---------------------------24583171312468616741133437317
  ... 
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="field.duplicateof"
  ... 
  ... 6
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="UPDATE_SUBMIT"
  ... 
  ... Change
  ... -----------------------------24583171312468616741133437317--
  ... """)
  HTTP/1.1 200 Ok
  ...
  ...An error occurred...
  ...already a duplicate...
  ...
  
  
  Tests the marking of a bug that is a duplicate of itself.

  >>> print http(r"""
  ... POST /products/ubuntu/+bug/1/+duplicate HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: multipart/form-data; boundary=---------------------------24583171312468616741133437317
  ... 
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="field.duplicateof"
  ... 
  ... 1
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="UPDATE_SUBMIT"
  ... 
  ... Change
  ... -----------------------------24583171312468616741133437317--
  ... """)
  HTTP/1.1 200 Ok
  ...
  ...An error occurred...
  ...can't...
  ...


  Tests the marking of a bug that is already marked as duplicate with
  the same value. In this case, nothing should happen, since nothing
  changed.

  >>> print http(r"""
  ... POST /products/firefox/+bug/6/+duplicate HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: multipart/form-data; boundary=---------------------------24583171312468616741133437317
  ... 
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="field.duplicateof"
  ... 
  ... 5
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="UPDATE_SUBMIT"
  ... 
  ... Change
  ... -----------------------------24583171312468616741133437317--
  ... """)
  HTTP/1.1 200 Ok 
  ...
  ...

  Tests the input of data that is not a valid integer value.


  >>> print http(r"""
  ... POST /products/firefox/+bug/6/+duplicate HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: multipart/form-data; boundary=---------------------------24583171312468616741133437317
  ... 
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="field.duplicateof"
  ... 
  ... xajskdjksajda
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="UPDATE_SUBMIT"
  ... 
  ... Change
  ... -----------------------------24583171312468616741133437317--
  ... """)
  HTTP/1.1 200 Ok 
  ...
  ...Not a valid bug number...
  ...


  Marking a bugX as a duplicate of bugY is not allowed if bugX has dupes.


  >>> print http(r"""
  ... POST /products/firefox/+bug/5/+duplicate HTTP/1.1
  ... Authorization: Basic dGVzdEBjYW5vbmljYWwuY29tOnRlc3Q=
  ... Content-Type: multipart/form-data; boundary=---------------------------24583171312468616741133437317
  ... 
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="field.duplicateof"
  ... 
  ... 4
  ... -----------------------------24583171312468616741133437317
  ... Content-Disposition: form-data; name="UPDATE_SUBMIT"
  ... 
  ... Change
  ... -----------------------------24583171312468616741133437317--
  ... """)
  HTTP/1.1 200 Ok 
  ...
  ...There are other bugs already...
  ...

  >>> from canonical.launchpad.database import Bug
  >>> Bug.get(5).duplicateof is None
  True
