= Branded RPs =

The OpenIDRPConfig table stores information about known RPs. These
can be branded.

    >>> from canonical.launchpad.database.openidserver import OpenIDRPConfig
    >>> rpconfig = OpenIDRPConfig(
    ...     trust_root='http://launchpad.dev/+openid-consumer',
    ...     displayname='Example Displayname',
    ...     description='Example Description',
    ...     logo=59)
    >>> import transaction
    >>> transaction.commit()


First, we need to associate with the OP.

    >>> from urllib import urlencode
    >>> anon_browser.open(
    ...     'http://openid.launchpad.dev/+openid', data=urlencode({
    ...         'openid.mode': 'associate',
    ...         'openid.assoc_type': 'HMAC-SHA1'}))
    >>> print anon_browser.headers
    Status: 200 Ok
    ...
    >>> import re
    >>> [assoc_handle] = re.findall('assoc_handle:(.*)', anon_browser.contents)

Now pull up the authorization screen.

    >>> args = urlencode({
    ...     'openid.mode': 'checkid_setup',
    ...     'openid.identity': 'http://openid.launchpad.dev/+id/sabdfl_oid',
    ...     'openid.assoc_handle': assoc_handle,
    ...     'openid.return_to': 'http://launchpad.dev/+openid-consumer',
    ...     })
    >>> anon_browser.open('http://openid.launchpad.dev/+openid?%s' % args)

On this screen, we find our branding information.

    >>> print '\n' + anon_browser.contents
    <BLANKLINE>
    ...
    <img alt="" src="http://localhost:58000/59/salgado-mugshot.jpg" />
    ...
    <h2>Example Displayname</h2>
    ...
    <p>Example Description</p>
    ...

