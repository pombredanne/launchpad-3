Creating new sprints
====================

We should also be able to create a new sprint. We do this off the
Sprints +new page.

    >>> user_browser.open('http://launchpad.dev/sprints')
    >>> user_browser.getLink('Register a meeting').click()

    >>> print user_browser.title
    Register a meeting...

First we'll test the name field validator.

    >>> user_browser.getControl('Name').value = 'ltsp_on_steroids!'
    >>> user_browser.getControl('Title').value = 'LTSP On Steroids'
    >>> summary = 'This is a sprint summary. Some words about the sprint'
    >>> user_browser.getControl('Summary').value = summary
    >>> user_browser.getControl('Driver').value = 'kamion'
    >>> user_browser.getControl('Home Page').value = 'http://www.willy.net'
    >>> user_browser.getControl('Timezone').value = ['UTC']
    >>> user_browser.getControl(
    ...     'Starting Date and Time').value = '10 Oct 2006 09:15'
    >>> user_browser.getControl(
    ...     'Finishing Date and Time').value = '13 Oct 2006 16:00'
    >>> user_browser.getControl('Add Sprint').click()

    >>> for tag in find_tags_by_class(user_browser.contents, 'message'):
    ...     print tag.renderContents()
    There is 1 error.
    <BLANKLINE>
    Invalid name 'ltsp_on_steroids!'. Names must be at least two characte...

Register a sprint with the same name of a existing one also returns a
nice error message

    >>> user_browser.getControl('Name').value = 'ubz'
    >>> user_browser.getControl('Add Sprint').click()

    >>> for tag in find_tags_by_class(user_browser.contents, 'message'):
    ...     print tag.renderContents()
    There is 1 error.
    <BLANKLINE>
    ubz is already in use by another sprint.

Create a new sprint with a finish date before the starting date returns
a error message.

    >>> user_browser.getControl('Name').value = 'ltsponsteroids'
    >>> user_browser.getControl(
    ...     'Starting Date and Time').value = '13 Oct 2006 09:15 '
    >>> user_browser.getControl(
    ...     'Finishing Date and Time').value = '10 Oct 2006 16:00'
    >>> user_browser.getControl('Add Sprint').click()

    >>> for tag in find_tags_by_class(user_browser.contents, 'message'):
    ...     print tag.renderContents()
    There is 1 error.
    <BLANKLINE>
    This event can't start after it ends

Also, the date is now presented in a canonicalised format, with time in
minutes rather than second-level accuracy:

    >>> user_browser.getControl('Starting Date and Time').value
    '2006-10-13 09:15'

    >>> user_browser.getControl('Finishing Date and Time').value
    '2006-10-10 16:00'

Fix the date and try again. We're redirected to the sprint home page for
the new sprint.

    >>> user_browser.getControl(
    ...     'Starting Date and Time').value = '10 Oct 2006 09:15 '
    >>> user_browser.getControl(
    ...     'Finishing Date and Time').value = '13 Oct 2006 16:00'
    >>> user_browser.getControl('Add Sprint').click()

    >>> user_browser.url
    'http://launchpad.dev/sprints/ltsponsteroids'

Since the sprint's time zone was set to UTC, the dates are displayed in
that time zone:

    >>> print extract_text(find_tag_by_id(user_browser.contents, 'start-end'))
    Starts: 09:15 UTC on Tuesday, 2006-10-10
    Ends: 16:00 UTC on Friday, 2006-10-13

Because this is a brand new sprint, it will have no specs, and we should
see a warning to that effect on the page.

    >>> message = 'Nobody has yet proposed any blueprints for discussion'
    >>> message in user_browser.contents
    True

Add a new sprint with a different time zone is also handled correctly.

    >>> user_browser.open('http://launchpad.dev/sprints/+new')
    >>> user_browser.getControl('Name').value = 'africa-sprint'
    >>> user_browser.getControl('Title').value = 'Africa Sprint'
    >>> summary = 'This is a sprint summary. Some words about the sprint'
    >>> user_browser.getControl('Summary').value = summary
    >>> user_browser.getControl('Home Page').value = 'http://www.ubuntu.com'
    >>> user_browser.getControl('Timezone').value = ['Africa/Johannesburg']
    >>> user_browser.getControl(
    ...     'Starting Date and Time').value = '10 Jul 2006 09:15'
    >>> user_browser.getControl(
    ...     'Finishing Date and Time').value = '13 Jul 2006 16:00'
    >>> user_browser.getControl('Add Sprint').click()

    >>> user_browser.url
    'http://launchpad.dev/sprints/africa-sprint'

    >>> print extract_text(find_tag_by_id(user_browser.contents, 'start-end'))
    Starts: 09:15 SAST on Monday, 2006-07-10
    Ends: 16:00 SAST on Thursday, 2006-07-13


