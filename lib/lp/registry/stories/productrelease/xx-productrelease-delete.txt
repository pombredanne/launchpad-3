= Deleting product releases =

The main page of a product series includes a list of releases of that series.
The 0.9.2 milestone has a release.

    >>> user_browser.open('http://launchpad.dev/firefox/trunk')
    >>> print user_browser.title
    Overview of Mozilla Firefox Series: trunk
    >>> print extract_text(find_tag_by_id(
    ...     user_browser.contents, 'series_trunk'))
    Version "Codename"         Expected   Released     Summary
    Mozilla Firefox 0.9.2 ...  None       2004-10-15   ...


A User with launchpad.Edit rights for a release can see the delete link and
access the delete page. A user without the necessary rights won't see the
link and cannot access the +delete page.

    >>> user_browser.getLink('0.9.2').click()
    >>> print user_browser.title
    Mozilla Firefox 0.9.2 "One (secure) Tree Hill"
    >>> user_browser.getLink(url='/firefox/trunk/0.9.2/+delete')
    Traceback (most recent call last):
    ...
    LinkNotFoundError
    >>> user_browser.open('http://launchpad.dev/firefox/trunk/0.9.2/+delete')
    Traceback (most recent call last):
    ...
    Unauthorized:...

Salgado has the necessary rights, so he sees the link and the +delete page.

    >>> salgados_browser = setupBrowser(auth='Basic salgado@ubuntu.com:zeca')
    >>> salgados_browser.open('http://launchpad.dev/firefox/trunk/0.9.2')
    >>> salgados_browser.getLink('Delete this release').click()
    >>> print salgados_browser.title
    Delete Mozilla Firefox 0.9.2...

The 0.9.2 release has some files associated with it. Salgado reads that
they will be deleted too.

    >>> print extract_text(find_main_content(salgados_browser.contents))
    Delete Mozilla Firefox 0.9.2 "One (secure) Tree Hill" ...
    The following files must be deleted:
    firefox-0.9.2.orig.tar.gz ...

Salgado chooses the delete button, then reads that the action is successful.

    >>> salgados_browser.getControl('Delete this Release').click()
    >>> print salgados_browser.title
    Overview of Mozilla Firefox Series: trunk
    >>> for message in get_feedback_messages(salgados_browser.contents):
    ...     print message
    Release 0.9.2 deleted.

Milestone 0.9.2 (which has the release) was the first item in the table,
but it is gone now that the release is deactivated.

    >>> print extract_text(
    ...     find_tag_by_id(salgados_browser.contents, 'series_trunk'))
    Version "Codename"
    Expected
    Released
    Summary
    Mozilla Firefox 0.9.1...
    Set
    Change details
    2004-10-15
    ...

