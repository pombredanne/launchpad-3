<tal:root
  xmlns:tal="http://xml.zope.org/namespaces/tal"
  xmlns:metal="http://xml.zope.org/namespaces/metal"
  xmlns:i18n="http://xml.zope.org/namespaces/i18n"
  omit-tag="">

<div class="portlet" id="contact-details"
  tal:define="overview_menu context/menu:overview">

  <h2 tal:condition="context/is_team">Contact details</h2>

  <div class="portletContent portletBody">

    <table>
      <tbody>

        <tr>

          <th>Email:</th>

          <td
            tal:attributes="title view/visible_email_address_description">
            <tal:not_logged_in
              condition="view/email_address_visibility/is_login_required">
              <a href="+login">Log in</a> for email information.
            </tal:not_logged_in>

            <tal:no_preferredemail
              condition="view/email_address_visibility/are_none_available">
              <tal:is-team condition="context/isTeam">
                No contact address
                <metal:define metal:define-macro="contact">
                  <tal:can-contact condition="view/can_contact">
                    (<a href="+contactuser"
                       tal:attributes="title view/contact_link_title"
                       tal:content="view/specific_contact_text">Contact this person</a>)
                    <tal:no_preferredemail
                      condition="view/email_address_visibility/are_none_available">
                      <br /><small>(Launchpad notifications are sent to all
                                    team members)</small>
                    </tal:no_preferredemail>
                  </tal:can-contact>
                </metal:define>
              </tal:is-team>
              <tal:comment replace="nothing">
              Otherwise the user is not valid; this portlet is not used.
              </tal:comment>
            </tal:no_preferredemail>

            <tal:cant-view-hidden-emails
              condition="view/email_address_visibility/are_hidden">
              No public address provided.
              <tal:contact metal:use-macro="template/macros/contact" />
            </tal:cant-view-hidden-emails>

            <tal:emails
              repeat="email view/visible_email_addresses">
              <span style="white-space: nowrap">
                <img src="/@@/private" alt=""
                  tal:condition="view/email_address_visibility/are_allowed"/>
                <img src="/@@/mail" alt=""
                  tal:condition="view/email_address_visibility/are_public"/>
                <tal:email replace="email">foo2@bar.com</tal:email>
                <tal:contact condition="repeat/email/start">
                  <tal:contact metal:use-macro="template/macros/contact" />
                </tal:contact>
                <br tal:omit-tag="repeat/email/end" />
              </span>
            </tal:emails>
          </td>
        </tr>

        <tr tal:condition="context/icon">
          <th>Icon:</th>
          <td><tal:icon replace="structure context/image:icon" /></td>
        </tr>
        <tal:XXX condition="nothing">
          # XXX: salgado, 2008-11-25 bug=296739: We should use
          # context/wiki_names/is_empty here, but we can't do that because
          # there's a bug preventing us from updating our version of storm
          # to trunk.
        </tal:XXX>
        <tr tal:condition="context/wiki_names/any">
          <th>Wiki:</th>
          <td>
            <span tal:repeat="wiki context/wiki_names">
              <a tal:content="wiki/url"
                 tal:attributes="href wiki/url"
               >WikiName</a><tal:block condition="not: repeat/wiki/end">,
               </tal:block>
            </span>
          </td>
        </tr>
        <tr tal:repeat="ircnick context/ircnicknames">
          <th>IRC:</th>
          <td><code style="font-size: 120%"
                    tal:content="ircnick/nickname"/>
              on network <code style="font-size: 120%"
                               tal:content="ircnick/network" />
          </td>
        </tr>
        <tr tal:condition="context/jabberids">
          <th>Jabber:</th>
          <td>
            <tal:block repeat="jabberid context/jabberids">
              <span tal:replace="jabberid/jabberid/fmt:obfuscate-email"
                /><span tal:condition="not: repeat/jabberid/end">,</span>
            </tal:block>
          </td>
        </tr>
        <tr tal:condition="context/gpgkeys">
          <th>OpenPGP keys:</th>
          <td>
            <tal:keys repeat="key context/gpgkeys">
              <a tal:attributes="href key/keyserverURL"
                 tal:omit-tag="not: request/lp:person">
                <tal:keyid replace="key/keyid"
                  /></a><span tal:condition="not: repeat/key/end">,</span>
            </tal:keys>
          </td>
        </tr>

        <tal:keys repeat="sshkey context/sshkeys">
          <tr>
            <th tal:condition="repeat/sshkey/start">
              SSH Keys:</th>
            <th tal:condition="not: repeat/sshkey/start">
            </th>
            <td tal:content="sshkey/comment" />
          </tr>
          <tr tal:condition="repeat/sshkey/end">
            <td>&nbsp;</td>
            <td><small><a href="+sshkeys">(view key text)</a></small></td>
          </tr>
        </tal:keys>

        <tr tal:condition="view/viewing_own_page" id="openid-info">
          <th>OpenID login:</th>
          <td>
            <img src="/@@/private" alt="" />
            <tal:openid-login content="view/openid_identity_url" />
            <a target="help" href="/+help/openid.html"
               >(What&rsquo;s&nbsp;this?)</a>
          </td>
        </tr>
        <tr id="languages">
          <th>Languages:</th>
          <td>
            <tal:languages content="view/languages">
              English
            </tal:languages>
            <a tal:replace="structure overview_menu/editlanguages/fmt:icon"/>
          </td>
        </tr>
      </tbody>
    </table>

  </div>

</div>

</tal:root>
